<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>961398513ea34466a6ee289c86d4e69f</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="dIz9YqoU2LC9">
<p>Montar drive para ler ficheiro da sales</p>
</div>
<div class="cell code" data-execution_count="1"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:4881,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895279650,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="J4m5YiJN2DoY" data-outputId="17526462-5ba5-4059-f349-bacceca09a94">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> google.colab <span class="im">import</span> drive</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>drive.mount(<span class="st">&#39;/content/drive&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(&quot;/content/drive&quot;, force_remount=True).
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="2"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-collapsed="true"
data-executionInfo="{&quot;elapsed&quot;:50477,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895330109,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="V3g6wRsJo3QY" data-outputId="fa63f965-aeec-4734-81ef-c19ddb407ea6">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> pip install ydata_profiling</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> pip install plotly</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="op">!</span> pip install fuzzywuzzy</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Requirement already satisfied: ydata_profiling in /usr/local/lib/python3.10/dist-packages (4.8.3)
Requirement already satisfied: scipy&lt;1.14,&gt;=1.4.1 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (1.11.4)
Requirement already satisfied: pandas!=1.4.0,&lt;3,&gt;1.1 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (2.0.3)
Requirement already satisfied: matplotlib&lt;3.9,&gt;=3.2 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (3.7.1)
Requirement already satisfied: pydantic&gt;=2 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (2.8.2)
Requirement already satisfied: PyYAML&lt;6.1,&gt;=5.0.0 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (6.0.1)
Requirement already satisfied: jinja2&lt;3.2,&gt;=2.11.1 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (3.1.4)
Requirement already satisfied: visions[type_image_path]&lt;0.7.7,&gt;=0.7.5 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (0.7.6)
Requirement already satisfied: numpy&lt;2,&gt;=1.16.0 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (1.25.2)
Requirement already satisfied: htmlmin==0.1.12 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (0.1.12)
Requirement already satisfied: phik&lt;0.13,&gt;=0.11.1 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (0.12.4)
Requirement already satisfied: requests&lt;3,&gt;=2.24.0 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (2.31.0)
Requirement already satisfied: tqdm&lt;5,&gt;=4.48.2 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (4.66.4)
Requirement already satisfied: seaborn&lt;0.14,&gt;=0.10.1 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (0.13.1)
Requirement already satisfied: multimethod&lt;2,&gt;=1.4 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (1.12)
Requirement already satisfied: statsmodels&lt;1,&gt;=0.13.2 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (0.14.2)
Requirement already satisfied: typeguard&lt;5,&gt;=3 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (4.3.0)
Requirement already satisfied: imagehash==4.3.1 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (4.3.1)
Requirement already satisfied: wordcloud&gt;=1.9.1 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (1.9.3)
Requirement already satisfied: dacite&gt;=1.8 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (1.8.1)
Requirement already satisfied: numba&lt;1,&gt;=0.56.0 in /usr/local/lib/python3.10/dist-packages (from ydata_profiling) (0.58.1)
Requirement already satisfied: PyWavelets in /usr/local/lib/python3.10/dist-packages (from imagehash==4.3.1-&gt;ydata_profiling) (1.6.0)
Requirement already satisfied: pillow in /usr/local/lib/python3.10/dist-packages (from imagehash==4.3.1-&gt;ydata_profiling) (9.4.0)
Requirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.10/dist-packages (from jinja2&lt;3.2,&gt;=2.11.1-&gt;ydata_profiling) (2.1.5)
Requirement already satisfied: contourpy&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&lt;3.9,&gt;=3.2-&gt;ydata_profiling) (1.2.1)
Requirement already satisfied: cycler&gt;=0.10 in /usr/local/lib/python3.10/dist-packages (from matplotlib&lt;3.9,&gt;=3.2-&gt;ydata_profiling) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&lt;3.9,&gt;=3.2-&gt;ydata_profiling) (4.53.1)
Requirement already satisfied: kiwisolver&gt;=1.0.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&lt;3.9,&gt;=3.2-&gt;ydata_profiling) (1.4.5)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.10/dist-packages (from matplotlib&lt;3.9,&gt;=3.2-&gt;ydata_profiling) (24.1)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /usr/local/lib/python3.10/dist-packages (from matplotlib&lt;3.9,&gt;=3.2-&gt;ydata_profiling) (3.1.2)
Requirement already satisfied: python-dateutil&gt;=2.7 in /usr/local/lib/python3.10/dist-packages (from matplotlib&lt;3.9,&gt;=3.2-&gt;ydata_profiling) (2.8.2)
Requirement already satisfied: llvmlite&lt;0.42,&gt;=0.41.0dev0 in /usr/local/lib/python3.10/dist-packages (from numba&lt;1,&gt;=0.56.0-&gt;ydata_profiling) (0.41.1)
Requirement already satisfied: pytz&gt;=2020.1 in /usr/local/lib/python3.10/dist-packages (from pandas!=1.4.0,&lt;3,&gt;1.1-&gt;ydata_profiling) (2023.4)
Requirement already satisfied: tzdata&gt;=2022.1 in /usr/local/lib/python3.10/dist-packages (from pandas!=1.4.0,&lt;3,&gt;1.1-&gt;ydata_profiling) (2024.1)
Requirement already satisfied: joblib&gt;=0.14.1 in /usr/local/lib/python3.10/dist-packages (from phik&lt;0.13,&gt;=0.11.1-&gt;ydata_profiling) (1.4.2)
Requirement already satisfied: annotated-types&gt;=0.4.0 in /usr/local/lib/python3.10/dist-packages (from pydantic&gt;=2-&gt;ydata_profiling) (0.7.0)
Requirement already satisfied: pydantic-core==2.20.1 in /usr/local/lib/python3.10/dist-packages (from pydantic&gt;=2-&gt;ydata_profiling) (2.20.1)
Requirement already satisfied: typing-extensions&gt;=4.6.1 in /usr/local/lib/python3.10/dist-packages (from pydantic&gt;=2-&gt;ydata_profiling) (4.12.2)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.24.0-&gt;ydata_profiling) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.24.0-&gt;ydata_profiling) (3.7)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.24.0-&gt;ydata_profiling) (2.0.7)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.10/dist-packages (from requests&lt;3,&gt;=2.24.0-&gt;ydata_profiling) (2024.7.4)
Requirement already satisfied: patsy&gt;=0.5.6 in /usr/local/lib/python3.10/dist-packages (from statsmodels&lt;1,&gt;=0.13.2-&gt;ydata_profiling) (0.5.6)
Requirement already satisfied: attrs&gt;=19.3.0 in /usr/local/lib/python3.10/dist-packages (from visions[type_image_path]&lt;0.7.7,&gt;=0.7.5-&gt;ydata_profiling) (23.2.0)
Requirement already satisfied: networkx&gt;=2.4 in /usr/local/lib/python3.10/dist-packages (from visions[type_image_path]&lt;0.7.7,&gt;=0.7.5-&gt;ydata_profiling) (3.3)
Requirement already satisfied: six in /usr/local/lib/python3.10/dist-packages (from patsy&gt;=0.5.6-&gt;statsmodels&lt;1,&gt;=0.13.2-&gt;ydata_profiling) (1.16.0)
Requirement already satisfied: plotly in /usr/local/lib/python3.10/dist-packages (5.15.0)
Requirement already satisfied: tenacity&gt;=6.2.0 in /usr/local/lib/python3.10/dist-packages (from plotly) (8.5.0)
Requirement already satisfied: packaging in /usr/local/lib/python3.10/dist-packages (from plotly) (24.1)
Requirement already satisfied: fuzzywuzzy in /usr/local/lib/python3.10/dist-packages (0.18.0)
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="3"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:9696,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895339788,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="sR7LWzZEomXO" data-outputId="869f06a0-899f-436c-bd4c-184f6cf9beb0">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># libraries</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ydata_profiling <span class="im">import</span> ProfileReport</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> ipywidgets <span class="im">as</span> widgets</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objs <span class="im">as</span> go</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> plotly.offline <span class="im">import</span> plot</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fuzzywuzzy <span class="im">import</span> fuzz</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fuzzywuzzy <span class="im">import</span> process</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Suppress warnings to enhance code readability</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>/usr/local/lib/python3.10/dist-packages/fuzzywuzzy/fuzz.py:11: UserWarning:

Using slow pure-python SequenceMatcher. Install python-Levenshtein to remove this warning

</code></pre>
</div>
</div>
<div class="cell markdown" id="EnIVQfVg7S6C">
<p>#Data Profiling</p>
</div>
<div class="cell code" data-execution_count="4"
data-executionInfo="{&quot;elapsed&quot;:56125,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895395908,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="nw6e0t1ZbJt4">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read datasets</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sales <span class="op">=</span> pd.read_csv(<span class="st">&#39;/content/drive/Shareddrives/Projeto II/CSV_raw/sales.csv&#39;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>product <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vTLVeXZeo0CrX_IoDUEgASMnqqfxSMLpt_tB_7dxOWRzXrYBJVKUEpA_lUmA2JrGw/pub?output=csv&#39;</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>cities <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vQVzyKZ9KHcOfW0uZwqUszAdI-opC72lYEAtpJBZxwuWTuvc_h18SIaCAgwvxXfHt2ixlraZCcs0Lrl/pub?output=csv&#39;</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>fore_rev <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://docs.google.com/spreadsheets/d/e/2PACX-1vQcchFjMPX1jweLzxW74vmshHbw0afm3VKEPffmsZCtHmduzWTcrO9T6HVLKJVXUw/pub?output=csv&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="5"
data-executionInfo="{&quot;elapsed&quot;:29,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895395909,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="_vNaQXFnH_xI">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#create a function to find outliers using IQR</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_outliers_iqr(dataframe, column_name):</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate Q1 (25th percentile) and Q3 (75th percentile)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    Q1 <span class="op">=</span> dataframe[column_name].quantile(<span class="fl">0.25</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>    Q3 <span class="op">=</span> dataframe[column_name].quantile(<span class="fl">0.75</span>)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the IQR (Interquartile Range)</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    IQR <span class="op">=</span> Q3 <span class="op">-</span> Q1</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate the lower and upper bounds for outliers</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    lower_bound <span class="op">=</span> Q1 <span class="op">-</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> Q3 <span class="op">+</span> <span class="fl">1.5</span> <span class="op">*</span> IQR</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Identify outliers</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    outliers <span class="op">=</span> dataframe[(dataframe[column_name] <span class="op">&lt;</span> lower_bound) <span class="op">|</span> (dataframe[column_name] <span class="op">&gt;</span> upper_bound)][column_name]</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> outliers</span></code></pre></div>
</div>
<div class="cell markdown" id="UvD7r_QJ7oVa">
<p>##Cities</p>
</div>
<div class="cell code" data-execution_count="6"
data-executionInfo="{&quot;elapsed&quot;:30,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895395911,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="Xy-W00h07cZV">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_cities = ProfileReport(cities, title=&quot;Cities Profiling Report&quot;)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_cities</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_cities.to_file(&quot;Cities Profiling Report.html&quot;)</span></span></code></pre></div>
</div>
<div class="cell markdown" id="5IPwnqrY5L-A">
<p>###Outliers Numerical variable</p>
</div>
<div class="cell code" data-execution_count="7"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:448}"
data-executionInfo="{&quot;elapsed&quot;:31,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895395913,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="ZEgCwtOd5VoM" data-outputId="d5c38ac5-6bae-4835-d0a3-de1422900d3c">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#In the profiling file, it was possible to see outliers in the histogram.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#However, the box plot was used to get a different view of the variable.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>cities.store_size.plot(kind<span class="op">=</span><span class="st">&#39;box&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="7">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/8fc7caab661653d0723fff4bbde19c8bc47ef022.png" /></p>
</div>
</div>
<div class="cell markdown" id="QbsOQrhxhWSa">
<p>As seen, there are outliers (60 and 63)</p>
</div>
<div class="cell code" data-execution_count="8"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:364,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895396264,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="SFaffZENIDUf" data-outputId="0557c2ad-dcc8-41cd-affd-7645092eaf15">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># outliers for store_size</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> find_outliers_iqr(cities, <span class="st">&#39;store_size&#39;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;number of outliers: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(outliers)))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;max outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">max</span>()))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;min outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">min</span>()))</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>outliers</span></code></pre></div>
<div class="output stream stdout">
<pre><code>number of outliers: 2
max outlier value: 63
min outlier value: 60
</code></pre>
</div>
<div class="output execute_result" data-execution_count="8">
<pre><code>5     63
39    60
Name: store_size, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="pVcvi7-TI7jB">
<p>###Cities names To see encoding issues</p>
</div>
<div class="cell code" data-execution_count="9"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:7,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895396264,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="aaeoOq3vI7On" data-outputId="66c5b4ed-0b3a-4851-a299-ab15fef57d29">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>cities[<span class="st">&#39;city_code&#39;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="9">
<pre><code>array([&#39;Denizli&#39;, &#39;Ankara&#39;, &#39;?zmir&#39;, &#39;Bursa&#39;, &#39;Antalya&#39;, &#39;Konya&#39;, &#39;Adana&#39;,
       &#39;Sanl?urfa&#39;, &#39;Gaziantep&#39;, &#39;Mersin&#39;, &#39;Diyarbak?r&#39;, &#39;Kayseri&#39;,
       &#39;Samsun&#39;, &#39;Istanbul&#39;, &#39;Eski?ehir&#39;, &#39;Adapazar?&#39;, &#39;Kahramanmaras&#39;,
       &#39;Erzurum&#39;, &#39;Van&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell markdown" id="WPjRkxUr7qg6">
<p>##Sales</p>
</div>
<div class="cell code" data-execution_count="10"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895396264,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="tKetad0w7cu4">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_sales = ProfileReport(sales, title=&quot;Sales Profiling Report&quot;)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_sales</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_sales.to_file(&quot;Sales Profiling Report.html&quot;)</span></span></code></pre></div>
</div>
<div class="cell markdown" id="me7YfNBMUg-g">
<p>###Outliers for numerical variables</p>
</div>
<div class="cell code" data-execution_count="11"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-collapsed="true"
data-executionInfo="{&quot;elapsed&quot;:4,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895396264,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="O3xerz3Nq9SN" data-outputId="6fba29b0-ab69-4cec-c48a-41776f14f379">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>sales.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 8886058 entries, 0 to 8886057
Data columns (total 14 columns):
 #   Column                 Dtype  
---  ------                 -----  
 0   Unnamed: 0             int64  
 1   store_id               object 
 2   product_id             object 
 3   date                   object 
 4   sales                  float64
 5   revenue                float64
 6   stock                  float64
 7   price                  float64
 8   promo_type_1           object 
 9   promo_bin_1            object 
 10  promo_type_2           object 
 11  promo_bin_2            object 
 12  promo_discount_2       float64
 13  promo_discount_type_2  object 
dtypes: float64(5), int64(1), object(8)
memory usage: 949.1+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="12"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:448}"
data-executionInfo="{&quot;elapsed&quot;:6580,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895402842,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="ynE8uolsVZNl" data-outputId="d39e5f34-c880-405c-b351-f679d03f46ed">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot for sales</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>sales.sales.plot(kind<span class="op">=</span><span class="st">&#39;box&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/9a6be965a64ed6ade81bd73e2285b26cad0e0a6c.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="13"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:705,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895403545,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="hjW5sCRcJEe7" data-outputId="8c14139b-2980-4d7a-aa80-d560da2e2633">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ouliers for sales</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> find_outliers_iqr(sales, <span class="st">&#39;sales&#39;</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;number of outliers: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(outliers)))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;max outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">max</span>()))</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;min outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">min</span>()))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>outliers</span></code></pre></div>
<div class="output stream stdout">
<pre><code>number of outliers: 1534855
max outlier value: 43301.0
min outlier value: 0.018
</code></pre>
</div>
<div class="output execute_result" data-execution_count="13">
<pre><code>3          1.0
5          1.0
7          2.0
9          7.0
15         1.0
          ... 
8583727    3.0
8583732    1.0
8583738    3.0
8583741    2.0
8583753    1.0
Name: sales, Length: 1534855, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown" id="9xtTn_BJ7rEE">
<p>Check if there are float numbers in sales</p>
</div>
<div class="cell code" data-execution_count="14"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:3602,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895407534,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="2l6okjqv7pgr" data-outputId="c86f36b6-0cc2-4b46-ceed-d12c30896f01">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to check if a value is a float</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_float(value):</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        float_value <span class="op">=</span> <span class="bu">float</span>(value)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">&#39;.&#39;</span> <span class="kw">in</span> <span class="bu">str</span>(value)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the column contains any float numbers</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>float_exists <span class="op">=</span> sales[<span class="st">&#39;sales&#39;</span>].<span class="bu">apply</span>(is_float).<span class="bu">any</span>()</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Does the column contain float numbers?&quot;</span>, float_exists)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Does the column contain float numbers? True
</code></pre>
</div>
</div>
<div class="cell markdown" id="3SdDhkd78cTO">
<p>Sales column that contain decimal numbers.</p>
</div>
<div class="cell code" data-execution_count="15"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:937,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895408457,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="FrlfpwZfB0yS" data-outputId="61f62ecf-120d-4fb9-8ac4-1236f8eaa1c5">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering out non-finite values</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>float_sales <span class="op">=</span> sales[<span class="st">&#39;sales&#39;</span>].dropna().replace([np.inf, <span class="op">-</span>np.inf], np.nan).dropna()</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering stores with float numbers in sales</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>float_sales <span class="op">=</span> sales[sales[<span class="st">&#39;sales&#39;</span>].isin(float_sales[float_sales <span class="op">!=</span> float_sales.astype(<span class="bu">int</span>)])]</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the stores</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(float_sales[<span class="st">&#39;store_id&#39;</span>].unique())</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(float_sales[<span class="st">&#39;store_id&#39;</span>].nunique())</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a><span class="co">#display the products</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(float_sales[<span class="st">&#39;product_id&#39;</span>].unique())</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(float_sales[<span class="st">&#39;product_id&#39;</span>].nunique())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;S0002&#39; &#39;S0003&#39; &#39;S0005&#39; &#39;S0010&#39; &#39;S0012&#39; &#39;S0014&#39; &#39;S0015&#39; &#39;S0016&#39; &#39;S0020&#39;
 &#39;S0022&#39; &#39;S0023&#39; &#39;S0026&#39; &#39;S0032&#39; &#39;S0036&#39; &#39;S0038&#39; &#39;S0039&#39; &#39;S0040&#39; &#39;S0045&#39;
 &#39;S0046&#39; &#39;S0050&#39; &#39;S0052&#39; &#39;S0055&#39; &#39;S0056&#39; &#39;S0058&#39; &#39;S0059&#39; &#39;S0061&#39; &#39;S0062&#39;
 &#39;S0067&#39; &#39;S0068&#39; &#39;S0071&#39; &#39;S0072&#39; &#39;S0073&#39; &#39;S0080&#39; &#39;S0083&#39; &#39;S0085&#39; &#39;S0086&#39;
 &#39;S0088&#39; &#39;S0089&#39; &#39;S0091&#39; &#39;S0092&#39; &#39;S0094&#39; &#39;S0095&#39; &#39;S0097&#39; &#39;S0099&#39; &#39;S0102&#39;
 &#39;S0104&#39; &#39;S0107&#39; &#39;S0108&#39; &#39;S0109&#39; &#39;S0120&#39; &#39;S0122&#39; &#39;S0126&#39; &#39;S0131&#39; &#39;S0132&#39;
 &#39;S0136&#39; &#39;S0142&#39; &#39;S0143&#39;]
57
[&#39;P0413&#39; &#39;P0561&#39; &#39;P0316&#39; &#39;P0176&#39; &#39;P0610&#39; &#39;P0630&#39; &#39;P0550&#39; &#39;P0725&#39; &#39;P0031&#39;
 &#39;P0155&#39; &#39;P0484&#39;]
11
</code></pre>
</div>
</div>
<div class="cell markdown" id="eC_o8T7gGN_K">
<p>57/63 stores have decimal numbers in sales: ['S0002' 'S0003' 'S0005'
'S0010' 'S0012' 'S0014' 'S0015' 'S0016' 'S0020' 'S0022' 'S0023' 'S0026'
'S0032' 'S0036' 'S0038' 'S0039' 'S0040' 'S0045' 'S0046' 'S0050' 'S0052'
'S0055' 'S0056' 'S0058' 'S0059' 'S0061' 'S0062' 'S0067' 'S0068' 'S0071'
'S0072' 'S0073' 'S0080' 'S0083' 'S0085' 'S0086' 'S0088' 'S0089' 'S0091'
'S0092' 'S0094' 'S0095' 'S0097' 'S0099' 'S0102' 'S0104' 'S0107' 'S0108'
'S0109' 'S0120' 'S0122' 'S0126' 'S0131' 'S0132' 'S0136' 'S0142'
'S0143']</p>
<p>11/615 products have decimal numbers in sales: ['P0413' 'P0561'
'P0316' 'P0176' 'P0610' 'P0630' 'P0550' 'P0725' 'P0031' 'P0155'
'P0484']</p>
</div>
<div class="cell code" data-execution_count="16"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895408458,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="lDqqXLj3EbDr" data-outputId="5ebdddf0-24a4-4ae4-9abf-547d3a4b783b">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Reset index</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>float_sales <span class="op">=</span> float_sales.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Select store_id and product_id columns from filtered DataFrame</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>float_sales <span class="op">=</span> float_sales[[<span class="st">&#39;store_id&#39;</span>, <span class="st">&#39;product_id&#39;</span>]]</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>float_sales</span></code></pre></div>
<div class="output execute_result" data-execution_count="16">

  <div id="df-c5a8c57d-0940-4f46-b500-cfda84b828d5" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>store_id</th>
      <th>product_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S0002</td>
      <td>P0413</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S0002</td>
      <td>P0413</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S0002</td>
      <td>P0413</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S0002</td>
      <td>P0413</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S0002</td>
      <td>P0413</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>17207</th>
      <td>S0143</td>
      <td>P0413</td>
    </tr>
    <tr>
      <th>17208</th>
      <td>S0143</td>
      <td>P0413</td>
    </tr>
    <tr>
      <th>17209</th>
      <td>S0143</td>
      <td>P0413</td>
    </tr>
    <tr>
      <th>17210</th>
      <td>S0143</td>
      <td>P0413</td>
    </tr>
    <tr>
      <th>17211</th>
      <td>S0143</td>
      <td>P0413</td>
    </tr>
  </tbody>
</table>
<p>17212 rows × 2 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c5a8c57d-0940-4f46-b500-cfda84b828d5')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c5a8c57d-0940-4f46-b500-cfda84b828d5 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c5a8c57d-0940-4f46-b500-cfda84b828d5');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-087cf2a4-acba-49bd-9268-2964802e4f75">
  <button class="colab-df-quickchart" onclick="quickchart('df-087cf2a4-acba-49bd-9268-2964802e4f75')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-087cf2a4-acba-49bd-9268-2964802e4f75 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_cb8f2648-5d3f-4015-9589-f1d9c803a025">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('float_sales')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_cb8f2648-5d3f-4015-9589-f1d9c803a025 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('float_sales');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="17"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:9,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895408458,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="kYMjL_6RJyuA" data-outputId="c145eb93-7a80-4e89-c6ce-7f4d023fbaae">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>filter_table <span class="op">=</span> pd.DataFrame(float_sales)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge final_table with cities on store_id to get storetype_id</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>merged_data <span class="op">=</span> pd.merge(filter_table, cities, on<span class="op">=</span><span class="st">&#39;store_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop duplicate store_id rows (if any) after merge</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>merged_data <span class="op">=</span> merged_data.drop_duplicates(subset<span class="op">=</span>[<span class="st">&#39;store_id&#39;</span>, <span class="st">&#39;storetype_id&#39;</span>])</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the result</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>filtered_data <span class="op">=</span> merged_data.<span class="bu">filter</span>([<span class="st">&#39;store_id&#39;</span>, <span class="st">&#39;storetype_id&#39;</span>])</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(filtered_data[<span class="st">&#39;storetype_id&#39;</span>].unique())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;ST04&#39; &#39;ST03&#39; &#39;ST01&#39; &#39;ST02&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="__Kwqh1UGByZ">
<p>all store types have sales with decimal numbers</p>
</div>
<div class="cell code" data-execution_count="18"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:448}"
data-executionInfo="{&quot;elapsed&quot;:7159,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895415612,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="P8K1PsIoVatF" data-outputId="e8735440-276d-4017-8bd5-02d561451e7c">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot for revenue</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sales.revenue.plot(kind<span class="op">=</span><span class="st">&#39;box&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="18">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/5c24cf268d9b00104e160f4f179c051ae6bbae93.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="19"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:796,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895416405,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="oIs-MQ2LG6Fm" data-outputId="3c7b168f-52d8-434c-e9cf-aac99beda377">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ouliers for revenue</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> find_outliers_iqr(sales, <span class="st">&#39;revenue&#39;</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;number of outliers: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(outliers)))</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;max outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">max</span>()))</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;min outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">min</span>()))</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>outliers</span></code></pre></div>
<div class="output stream stdout">
<pre><code>number of outliers: 1533783
max outlier value: 84197.961
min outlier value: 0.01
</code></pre>
</div>
<div class="output execute_result" data-execution_count="19">
<pre><code>3           2.41
5           1.81
7           4.54
9           4.54
15          5.79
           ...  
8583727     4.50
8583732     4.40
8583738    22.22
8583741     8.80
8583753     5.51
Name: revenue, Length: 1533783, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="20"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:448}"
data-executionInfo="{&quot;elapsed&quot;:2675,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895419078,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="H2R7b03jVcA0" data-outputId="3fb1008a-892d-46c9-87e8-05b439791ab6">
<div class="sourceCode" id="cb37"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot for stock</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>sales.stock.plot(kind<span class="op">=</span><span class="st">&#39;box&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="20">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/48ce6cdb7022dff3628a1665390ec25f420042b4.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="21"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:961,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895420037,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="213JjHwJJH4c" data-outputId="09899467-e9ab-4d21-d9fa-0f01e7c0beed">
<div class="sourceCode" id="cb39"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ouliers for stock</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> find_outliers_iqr(sales, <span class="st">&#39;stock&#39;</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;number of outliers: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(outliers)))</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;max outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">max</span>()))</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;min outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">min</span>()))</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>outliers</span></code></pre></div>
<div class="output stream stdout">
<pre><code>number of outliers: 674701
max outlier value: 4655.0
min outlier value: 36.525
</code></pre>
</div>
<div class="output execute_result" data-execution_count="21">
<pre><code>5           37.0
9          132.0
16          55.0
22          46.0
27          58.0
           ...  
8583474     44.0
8583543     44.0
8583610     44.0
8583677     44.0
8583747     44.0
Name: stock, Length: 674701, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="22"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:448}"
data-executionInfo="{&quot;elapsed&quot;:2989,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895423023,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="d6uiSNzXVc8Q" data-outputId="59108f6f-4d30-4d67-a455-c57a9b8bac22">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#boxplot for price</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>sales.price.plot(kind<span class="op">=</span><span class="st">&#39;box&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="22">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/1c6b2a892d9d49413e770b31ce361c2dcc43dc36.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="23"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1004,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895424024,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="bQauDw5uJR_K" data-outputId="a5813db3-0f0b-4846-aff8-37fb1325e53b">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ouliers for price</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> find_outliers_iqr(sales, <span class="st">&#39;price&#39;</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;number of outliers: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(outliers)))</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;max outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">max</span>()))</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;min outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">min</span>()))</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>outliers</span></code></pre></div>
<div class="output stream stdout">
<pre><code>number of outliers: 747066
max outlier value: 1599.0
min outlier value: 37.25
</code></pre>
</div>
<div class="output execute_result" data-execution_count="23">
<pre><code>2           49.9
21          99.9
52          59.9
58          59.9
88          53.9
           ...  
8885982     41.5
8885986    139.9
8886000     89.9
8886050     41.5
8886054    139.9
Name: price, Length: 747066, dtype: float64</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="24"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:448}"
data-executionInfo="{&quot;elapsed&quot;:314,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895424334,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="X0jKXInoVeTc" data-outputId="bad3dab5-5f16-4fea-97c1-532915f6b0ad">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># boxplot for promo_discount_2</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>sales.promo_discount_2.plot(kind<span class="op">=</span><span class="st">&#39;box&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="24">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/bb510de5a77966b67f84ad70673b5a21f705227a.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="25"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:1397,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895425727,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="mtExwzvsJVjj" data-outputId="6a66b617-05cd-4394-b9c1-f247a73a7cbf">
<div class="sourceCode" id="cb49"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ouliers for promo_discount_2</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>outliers <span class="op">=</span> find_outliers_iqr(sales, <span class="st">&#39;sales&#39;</span>)</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;number of outliers: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(<span class="bu">len</span>(outliers)))</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;max outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">max</span>()))</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;min outlier value: &#39;</span> <span class="op">+</span> <span class="bu">str</span>(outliers.<span class="bu">min</span>()))</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>outliers</span></code></pre></div>
<div class="output stream stdout">
<pre><code>number of outliers: 1534855
max outlier value: 43301.0
min outlier value: 0.018
</code></pre>
</div>
<div class="output execute_result" data-execution_count="25">
<pre><code>3          1.0
5          1.0
7          2.0
9          7.0
15         1.0
          ... 
8583727    3.0
8583732    1.0
8583738    3.0
8583741    2.0
8583753    1.0
Name: sales, Length: 1534855, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown" id="mlEVy5eCSfcu">
<p>###Sales per year Comparison between months and years</p>
</div>
<div class="cell code" data-execution_count="26"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:2136,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895427861,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="wFfpgC6MYu9v" data-outputId="800e45ae-b6cc-4be4-876c-012c2d0cd97c">
<div class="sourceCode" id="cb52"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert &#39;date&#39; column to datetime format</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>sales[<span class="st">&#39;date&#39;</span>] <span class="op">=</span> pd.to_datetime(sales[<span class="st">&#39;date&#39;</span>])</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>sales.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 8886058 entries, 0 to 8886057
Data columns (total 14 columns):
 #   Column                 Dtype         
---  ------                 -----         
 0   Unnamed: 0             int64         
 1   store_id               object        
 2   product_id             object        
 3   date                   datetime64[ns]
 4   sales                  float64       
 5   revenue                float64       
 6   stock                  float64       
 7   price                  float64       
 8   promo_type_1           object        
 9   promo_bin_1            object        
 10  promo_type_2           object        
 11  promo_bin_2            object        
 12  promo_discount_2       float64       
 13  promo_discount_type_2  object        
dtypes: datetime64[ns](1), float64(5), int64(1), object(7)
memory usage: 949.1+ MB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="27"
data-executionInfo="{&quot;elapsed&quot;:52200,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895480059,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="r5J8_P_6Y5lf">
<div class="sourceCode" id="cb54"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract year and month</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>sales[<span class="st">&#39;Year&#39;</span>] <span class="op">=</span> sales[<span class="st">&#39;date&#39;</span>].dt.year</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>sales[<span class="st">&#39;Month&#39;</span>] <span class="op">=</span> sales[<span class="st">&#39;date&#39;</span>].dt.strftime(<span class="st">&#39;%b&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="28"
data-executionInfo="{&quot;elapsed&quot;:2077,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895482120,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="mWdspYe8Z67X">
<div class="sourceCode" id="cb55"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Separate DataFrames for each year</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>df_2017 <span class="op">=</span> sales[sales[<span class="st">&#39;Year&#39;</span>] <span class="op">==</span> <span class="dv">2017</span>]</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>df_2018 <span class="op">=</span> sales[sales[<span class="st">&#39;Year&#39;</span>] <span class="op">==</span> <span class="dv">2018</span>]</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>df_2019 <span class="op">=</span> sales[sales[<span class="st">&#39;Year&#39;</span>] <span class="op">==</span> <span class="dv">2019</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="29"
data-executionInfo="{&quot;elapsed&quot;:1089,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895483206,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="mkQUEDXDc858">
<div class="sourceCode" id="cb56"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by month for each year</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>grouped_2017 <span class="op">=</span> df_2017.groupby(df_2017[<span class="st">&#39;date&#39;</span>].dt.month)[<span class="st">&#39;sales&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>grouped_2018 <span class="op">=</span> df_2018.groupby(df_2018[<span class="st">&#39;date&#39;</span>].dt.month)[<span class="st">&#39;sales&#39;</span>].<span class="bu">sum</span>()</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>grouped_2019 <span class="op">=</span> df_2019.groupby(df_2019[<span class="st">&#39;date&#39;</span>].dt.month)[<span class="st">&#39;sales&#39;</span>].<span class="bu">sum</span>()</span></code></pre></div>
</div>
<section id="plotting-the-data" class="cell markdown" id="vjvK2ijKam9X">
<h4>Plotting the data</h4>
</section>
<div class="cell code" data-execution_count="30"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:607}"
data-executionInfo="{&quot;elapsed&quot;:792,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895483994,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="JH5ktoi2Se6m" data-outputId="e0e4dc0c-68ae-4e54-c2db-b23b809a47e0">
<div class="sourceCode" id="cb57"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_2017.index, grouped_2017.values, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>, label<span class="op">=</span><span class="st">&#39;2017&#39;</span>)</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_2018.index, grouped_2018.values, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>, label<span class="op">=</span><span class="st">&#39;2018&#39;</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>plt.plot(grouped_2019.index, grouped_2019.values, marker<span class="op">=</span><span class="st">&#39;o&#39;</span>, linestyle<span class="op">=</span><span class="st">&#39;-&#39;</span>, label<span class="op">=</span><span class="st">&#39;2019&#39;</span>)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Monthly Sales by Year&#39;</span>)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Month&#39;</span>)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Sales&#39;</span>)</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>plt.xticks(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">13</span>), [<span class="st">&#39;Jan&#39;</span>, <span class="st">&#39;Feb&#39;</span>, <span class="st">&#39;Mar&#39;</span>, <span class="st">&#39;Apr&#39;</span>, <span class="st">&#39;May&#39;</span>, <span class="st">&#39;Jun&#39;</span>, <span class="st">&#39;Jul&#39;</span>, <span class="st">&#39;Aug&#39;</span>, <span class="st">&#39;Sep&#39;</span>, <span class="st">&#39;Oct&#39;</span>, <span class="st">&#39;Nov&#39;</span>, <span class="st">&#39;Dec&#39;</span>])</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>plt.grid(<span class="va">True</span>)</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/7247654056d6bde8c456067c9143c9a14b3ebc96.png" /></p>
</div>
</div>
<div class="cell markdown" id="BAx6YpeFe9PQ">
<p>Avg Sales By Day, Week, Month and Day Of Week</p>
</div>
<div class="cell code" data-execution_count="31"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:237}"
data-executionInfo="{&quot;elapsed&quot;:7552,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895491543,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="X9KyrMbQe8i1" data-outputId="9a1a8a22-1496-4e94-ddbd-7b21cccd6d1b">
<div class="sourceCode" id="cb58"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set date as index</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> sales.copy()</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>df.set_index(<span class="st">&#39;date&#39;</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure the DataFrame is sorted by date</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>df.sort_index(inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="co"># confirm index</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="31">

  <div id="df-ded52fea-324a-40f0-83b3-c81dd48400ba" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Unnamed: 0</th>
      <th>store_id</th>
      <th>product_id</th>
      <th>sales</th>
      <th>revenue</th>
      <th>stock</th>
      <th>price</th>
      <th>promo_type_1</th>
      <th>promo_bin_1</th>
      <th>promo_type_2</th>
      <th>promo_bin_2</th>
      <th>promo_discount_2</th>
      <th>promo_discount_type_2</th>
      <th>Year</th>
      <th>Month</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2017-01-02</th>
      <td>1</td>
      <td>S0002</td>
      <td>P0001</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>8.00</td>
      <td>6.25</td>
      <td>PR14</td>
      <td>NaN</td>
      <td>PR03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2017</td>
      <td>Jan</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>374614</td>
      <td>S0010</td>
      <td>P0413</td>
      <td>12.175</td>
      <td>55.80</td>
      <td>16.29</td>
      <td>2.99</td>
      <td>PR14</td>
      <td>NaN</td>
      <td>PR03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2017</td>
      <td>Jan</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>374615</td>
      <td>S0010</td>
      <td>P0425</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>4.00</td>
      <td>4.50</td>
      <td>PR14</td>
      <td>NaN</td>
      <td>PR03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2017</td>
      <td>Jan</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>374616</td>
      <td>S0010</td>
      <td>P0427</td>
      <td>0.000</td>
      <td>0.00</td>
      <td>12.00</td>
      <td>2.45</td>
      <td>PR06</td>
      <td>low</td>
      <td>PR03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2017</td>
      <td>Jan</td>
    </tr>
    <tr>
      <th>2017-01-02</th>
      <td>374617</td>
      <td>S0010</td>
      <td>P0435</td>
      <td>1.000</td>
      <td>21.61</td>
      <td>6.00</td>
      <td>25.50</td>
      <td>PR14</td>
      <td>NaN</td>
      <td>PR03</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2017</td>
      <td>Jan</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ded52fea-324a-40f0-83b3-c81dd48400ba')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ded52fea-324a-40f0-83b3-c81dd48400ba button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ded52fea-324a-40f0-83b3-c81dd48400ba');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-14924485-0012-4a05-84ed-fef59061cb85">
  <button class="colab-df-quickchart" onclick="quickchart('df-14924485-0012-4a05-84ed-fef59061cb85')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-14924485-0012-4a05-84ed-fef59061cb85 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="32"
data-executionInfo="{&quot;elapsed&quot;:1192,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895492733,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="3p4oZ0rafPHn">
<div class="sourceCode" id="cb59"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return only sales &gt;0</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[df[<span class="st">&#39;sales&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="33"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
data-executionInfo="{&quot;elapsed&quot;:6128,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895498859,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="dlPOf99bfaKo" data-outputId="6d1c6676-5822-437a-c34a-dde5a3550a7c">
<div class="sourceCode" id="cb60"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot average  sales</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>daily_sales<span class="op">=</span>df.resample(<span class="st">&#39;D&#39;</span>).sales.mean().to_frame()  <span class="co"># Resample sales by day</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>weekly_sales<span class="op">=</span>df.resample(<span class="st">&#39;W&#39;</span>).sales.mean().to_frame()  <span class="co"># Resample sales by week</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>monthly_sales<span class="op">=</span>df.resample(<span class="st">&#39;M&#39;</span>).sales.mean().to_frame()  <span class="co"># Resample sales by month</span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>df_list<span class="op">=</span>[daily_sales,weekly_sales,monthly_sales]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>titles<span class="op">=</span>[<span class="st">&#39;Daily Avg. Sales&#39;</span>,<span class="st">&#39;Weekly Avg. Sales&#39;</span>,<span class="st">&#39;Monthly Avg. Sales&#39;</span>]</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i,j <span class="kw">in</span> <span class="bu">zip</span>(df_list,titles):</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>    sns.relplot(x<span class="op">=</span>i.index,y<span class="op">=</span>i.sales,kind<span class="op">=</span><span class="st">&#39;line&#39;</span>,aspect<span class="op">=</span><span class="dv">3</span>,hue<span class="op">=</span>i.index.year)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Date&#39;</span>)</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Avg. Sales&#39;</span>)</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>    plt.title(j)</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/44652324e1ff34ea533fe11d962180f84b2c93d2.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/3568556c8f28a6f37919575409062aabe3d46264.png" /></p>
</div>
<div class="output display_data">
<p><img
src="vertopal_af76a5d7d8c5413e9a3f66428a75af8c/90c93835da8df696a352661646c8a86efc956478.png" /></p>
</div>
</div>
<div class="cell markdown" id="dCYKNPg0ff_9">
<p>Total sales over time</p>
</div>
<div class="cell markdown" id="6-w9HSAbjvTu">
<p>###October 2019 Based on the previous analysis, was possible to see
sales of October 2019 = 0.</p>
</div>
<div class="cell code" data-execution_count="34"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:12,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895498860,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="ANrihB4xjn6w" data-outputId="91651242-5e8a-41f0-c5c2-8167046ba838">
<div class="sourceCode" id="cb61"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>sales_oct<span class="op">=</span>df_2019[df_2019[<span class="st">&#39;Month&#39;</span>]<span class="op">==</span> <span class="st">&#39;Oct&#39;</span>]</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sales_oct.shape)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sales_oct.isnull().<span class="bu">sum</span>())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>(302296, 16)
Unnamed: 0                    0
store_id                      0
product_id                    0
date                          0
sales                    302296
revenue                  302296
stock                    302296
price                      1972
promo_type_1                  0
promo_bin_1              251772
promo_type_2                  0
promo_bin_2              298058
promo_discount_2         298058
promo_discount_type_2    298058
Year                          0
Month                         0
dtype: int64
</code></pre>
</div>
</div>
<div class="cell markdown" id="OZ4ULjh68cK_">
<p>There are no records in revenue, sales and stock variables on October
2019.</p>
</div>
<section id="sales-per-store" class="cell markdown" id="0FhZVQPudezL">
<h3>Sales per store</h3>
</section>
<div class="cell code" data-execution_count="35"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
data-executionInfo="{&quot;elapsed&quot;:9822,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895508679,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="pVaAvuKW5ORv" data-outputId="a51af28b-5259-4f71-8aeb-93864f0336d3">
<div class="sourceCode" id="cb63"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the sales DataFrame to include only positive sales</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>filtered_sales <span class="op">=</span> sales[sales[<span class="st">&#39;sales&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>df_sales_store <span class="op">=</span> filtered_sales.groupby([<span class="st">&#39;store_id&#39;</span>, <span class="st">&#39;Year&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>df_sales_store_p <span class="op">=</span> df_sales_store.pivot(index<span class="op">=</span><span class="st">&#39;store_id&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Year&#39;</span>, values<span class="op">=</span><span class="st">&#39;count&#39;</span>).reset_index()</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>df_sales_store_p.columns.name <span class="op">=</span> <span class="va">None</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column for the sum of each store across all years</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>df_sales_store_p[<span class="st">&#39;total&#39;</span>] <span class="op">=</span> df_sales_store.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>df_sales_store_p</span></code></pre></div>
<div class="output execute_result" data-execution_count="35">

  <div id="df-5540614a-c852-4aeb-85db-f90cb4358598" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>store_id</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S0002</td>
      <td>12832.0</td>
      <td>13590.0</td>
      <td>9525.0</td>
      <td>14849</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S0003</td>
      <td>5832.0</td>
      <td>6036.0</td>
      <td>4239.0</td>
      <td>15608</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S0005</td>
      <td>NaN</td>
      <td>5254.0</td>
      <td>3868.0</td>
      <td>11544</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S0007</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2591.0</td>
      <td>7849</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S0010</td>
      <td>12060.0</td>
      <td>11886.0</td>
      <td>7872.0</td>
      <td>8054</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58</th>
      <td>S0132</td>
      <td>10640.0</td>
      <td>11566.0</td>
      <td>8502.0</td>
      <td>6157</td>
    </tr>
    <tr>
      <th>59</th>
      <td>S0136</td>
      <td>840.0</td>
      <td>1364.0</td>
      <td>1164.0</td>
      <td>7033</td>
    </tr>
    <tr>
      <th>60</th>
      <td>S0141</td>
      <td>3815.0</td>
      <td>3812.0</td>
      <td>2252.0</td>
      <td>6252</td>
    </tr>
    <tr>
      <th>61</th>
      <td>S0142</td>
      <td>7231.0</td>
      <td>8167.0</td>
      <td>5367.0</td>
      <td>10241</td>
    </tr>
    <tr>
      <th>62</th>
      <td>S0143</td>
      <td>3124.0</td>
      <td>3124.0</td>
      <td>2185.0</td>
      <td>11686</td>
    </tr>
  </tbody>
</table>
<p>63 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5540614a-c852-4aeb-85db-f90cb4358598')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5540614a-c852-4aeb-85db-f90cb4358598 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5540614a-c852-4aeb-85db-f90cb4358598');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-196a7438-4603-45ed-9485-dca352a8b211">
  <button class="colab-df-quickchart" onclick="quickchart('df-196a7438-4603-45ed-9485-dca352a8b211')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-196a7438-4603-45ed-9485-dca352a8b211 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_11671b29-db15-4684-ad8a-d8caf82dc9a4">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_sales_store_p')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_11671b29-db15-4684-ad8a-d8caf82dc9a4 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_sales_store_p');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="36"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
data-executionInfo="{&quot;elapsed&quot;:131,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895508679,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="B9VhqyRZ-4Uv" data-outputId="eb177d44-1834-4b60-8999-d155d98e4630">
<div class="sourceCode" id="cb64"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt the DataFrame to long format for use with plotly</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>df_long <span class="op">=</span> pd.melt(df_sales_store_p, id_vars<span class="op">=</span>[<span class="st">&#39;store_id&#39;</span>], value_vars<span class="op">=</span>[<span class="dv">2017</span>, <span class="dv">2018</span>, <span class="dv">2019</span>],</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>                  var_name<span class="op">=</span><span class="st">&#39;Year&#39;</span>, value_name<span class="op">=</span><span class="st">&#39;count&#39;</span>).dropna()</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot using plotly.express</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(df_long, x<span class="op">=</span><span class="st">&#39;store_id&#39;</span>, y<span class="op">=</span><span class="st">&#39;count&#39;</span>, color<span class="op">=</span><span class="st">&#39;Year&#39;</span>,</span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>             title<span class="op">=</span><span class="st">&#39;Sales Count per Store by Year&#39;</span>,</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>             labels<span class="op">=</span>{<span class="st">&#39;store_id&#39;</span>: <span class="st">&#39;Store ID&#39;</span>, <span class="st">&#39;count&#39;</span>: <span class="st">&#39;Sales Count&#39;</span>})</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Update layout for better readability</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(xaxis<span class="op">=</span><span class="bu">dict</span>(tickangle<span class="op">=</span><span class="dv">45</span>))</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="cb4f9212-09c8-480e-b6b5-3789611dd16f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("cb4f9212-09c8-480e-b6b5-3789611dd16f")) {                    Plotly.newPlot(                        "cb4f9212-09c8-480e-b6b5-3789611dd16f",                        [{"alignmentgroup":"True","hovertemplate":"Year=2017\u003cbr\u003eStore ID=%{x}\u003cbr\u003eSales Count=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"2017","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"2017","offsetgroup":"2017","orientation":"v","showlegend":true,"textposition":"auto","x":["S0002","S0003","S0010","S0012","S0014","S0015","S0016","S0020","S0022","S0023","S0026","S0030","S0032","S0038","S0039","S0040","S0041","S0045","S0050","S0052","S0055","S0056","S0058","S0059","S0062","S0067","S0068","S0072","S0073","S0077","S0080","S0083","S0085","S0086","S0088","S0089","S0091","S0094","S0095","S0097","S0099","S0102","S0104","S0107","S0108","S0120","S0122","S0126","S0131","S0132","S0136","S0141","S0142","S0143"],"xaxis":"x","y":[12832.0,5832.0,12060.0,8199.0,6490.0,12162.0,5189.0,22846.0,9889.0,12453.0,24261.0,2934.0,5203.0,20651.0,4116.0,13295.0,2942.0,5152.0,8224.0,7931.0,8549.0,13626.0,10027.0,2199.0,24349.0,8211.0,3174.0,8948.0,6436.0,3962.0,8025.0,4248.0,31310.0,2690.0,5489.0,2575.0,6902.0,13459.0,19125.0,20829.0,3514.0,9720.0,15852.0,7812.0,12807.0,3164.0,7478.0,12963.0,7977.0,10640.0,840.0,3815.0,7231.0,3124.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"Year=2018\u003cbr\u003eStore ID=%{x}\u003cbr\u003eSales Count=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"2018","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"2018","offsetgroup":"2018","orientation":"v","showlegend":true,"textposition":"auto","x":["S0002","S0003","S0005","S0010","S0012","S0014","S0015","S0016","S0020","S0022","S0023","S0026","S0030","S0032","S0036","S0038","S0039","S0040","S0041","S0045","S0046","S0050","S0052","S0055","S0056","S0058","S0059","S0061","S0062","S0067","S0068","S0071","S0072","S0073","S0076","S0077","S0080","S0083","S0085","S0086","S0088","S0089","S0091","S0092","S0094","S0095","S0097","S0099","S0102","S0104","S0107","S0108","S0109","S0120","S0122","S0126","S0131","S0132","S0136","S0141","S0142","S0143"],"xaxis":"x","y":[13590.0,6036.0,5254.0,11886.0,8846.0,6035.0,12803.0,5182.0,23491.0,9313.0,13385.0,25716.0,2693.0,5332.0,6065.0,23706.0,4404.0,13822.0,2540.0,6000.0,5015.0,9668.0,7577.0,9192.0,15006.0,10037.0,5362.0,9764.0,26122.0,8676.0,3457.0,5623.0,12686.0,6591.0,3677.0,3831.0,8299.0,4616.0,34624.0,2637.0,5389.0,2746.0,7528.0,1940.0,16665.0,18962.0,23102.0,4138.0,9487.0,17899.0,7432.0,13830.0,1761.0,2677.0,8318.0,13466.0,7991.0,11566.0,1364.0,3812.0,8167.0,3124.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"Year=2019\u003cbr\u003eStore ID=%{x}\u003cbr\u003eSales Count=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"2019","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"2019","offsetgroup":"2019","orientation":"v","showlegend":true,"textposition":"auto","x":["S0002","S0003","S0005","S0007","S0010","S0012","S0014","S0015","S0016","S0020","S0022","S0023","S0026","S0030","S0032","S0036","S0038","S0039","S0040","S0041","S0045","S0046","S0050","S0052","S0055","S0056","S0058","S0059","S0061","S0062","S0067","S0068","S0071","S0072","S0073","S0076","S0077","S0080","S0083","S0085","S0086","S0088","S0089","S0091","S0092","S0094","S0095","S0097","S0099","S0102","S0104","S0107","S0108","S0109","S0120","S0122","S0126","S0131","S0132","S0136","S0141","S0142","S0143"],"xaxis":"x","y":[9525.0,4239.0,3868.0,2591.0,7872.0,5666.0,4493.0,8451.0,3769.0,16321.0,6299.0,9644.0,17384.0,2462.0,3940.0,4839.0,16170.0,3001.0,9526.0,1669.0,4138.0,4233.0,7065.0,4436.0,6352.0,10819.0,6384.0,3751.0,9807.0,18481.0,6177.0,2609.0,7185.0,9415.0,4777.0,4705.0,2386.0,5863.0,3331.0,24136.0,2076.0,4063.0,1933.0,5306.0,4244.0,12403.0,13405.0,16262.0,2613.0,5981.0,13260.0,4476.0,9535.0,5427.0,2006.0,5823.0,9276.0,5863.0,8502.0,1164.0,2252.0,5367.0,2185.0],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Store ID"},"tickangle":45},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Sales Count"}},"legend":{"title":{"text":"Year"},"tracegroupgap":0},"title":{"text":"Sales Count per Store by Year"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('cb4f9212-09c8-480e-b6b5-3789611dd16f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html>
</div>
</div>
<div class="cell markdown" id="Met_KBeJ_VTb">
<p>S0085 seems to have more sells, followed by S0062 and S0026 Some
stores do not show data for 2017 sales -&gt; only opened after? (S0005,
S0036, S0046, S0061, S0071, S0076, S0092, S0109) S0007 only shows values
for 2019 -&gt; only opened in 2019?</p>
</div>
<section id="revenue-per-store" class="cell markdown" id="No8KwKjsfY1t">
<h1>Revenue per store</h1>
</section>
<div class="cell code" data-execution_count="37"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
data-executionInfo="{&quot;elapsed&quot;:154,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895508703,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="ewbriaFsfbGE" data-outputId="09b287e6-c959-4794-f4aa-42cb9b783ab2">
<div class="sourceCode" id="cb65"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Group by store_id and Year, then sum the revenue</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>df_revenue_store <span class="op">=</span> filtered_sales.groupby([<span class="st">&#39;store_id&#39;</span>, <span class="st">&#39;Year&#39;</span>])[<span class="st">&#39;revenue&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>df_revenue_store_p <span class="op">=</span> df_revenue_store.pivot(index<span class="op">=</span><span class="st">&#39;store_id&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Year&#39;</span>, values<span class="op">=</span><span class="st">&#39;revenue&#39;</span>).reset_index()</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>df_revenue_store_p.columns.name <span class="op">=</span> <span class="va">None</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column for the sum of revenue for each store across all years</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>df_revenue_store_p[<span class="st">&#39;total_rev&#39;</span>] <span class="op">=</span> df_revenue_store_p.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>df_revenue_store_p</span></code></pre></div>
<div class="output execute_result" data-execution_count="37">

  <div id="df-ed3eb706-11d8-489d-8fe5-7a61e348be37" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>store_id</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>total_rev</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>S0002</td>
      <td>125121.21</td>
      <td>175934.93</td>
      <td>173764.53</td>
      <td>474820.67</td>
    </tr>
    <tr>
      <th>1</th>
      <td>S0003</td>
      <td>32671.81</td>
      <td>45476.80</td>
      <td>48837.80</td>
      <td>126986.41</td>
    </tr>
    <tr>
      <th>2</th>
      <td>S0005</td>
      <td>NaN</td>
      <td>52677.04</td>
      <td>49383.51</td>
      <td>102060.55</td>
    </tr>
    <tr>
      <th>3</th>
      <td>S0007</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>21828.81</td>
      <td>21828.81</td>
    </tr>
    <tr>
      <th>4</th>
      <td>S0010</td>
      <td>107462.65</td>
      <td>128455.10</td>
      <td>111551.65</td>
      <td>347469.40</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>58</th>
      <td>S0132</td>
      <td>77662.74</td>
      <td>109195.17</td>
      <td>119892.39</td>
      <td>306750.30</td>
    </tr>
    <tr>
      <th>59</th>
      <td>S0136</td>
      <td>4932.36</td>
      <td>9363.40</td>
      <td>13311.78</td>
      <td>27607.54</td>
    </tr>
    <tr>
      <th>60</th>
      <td>S0141</td>
      <td>14213.18</td>
      <td>18244.17</td>
      <td>13844.22</td>
      <td>46301.57</td>
    </tr>
    <tr>
      <th>61</th>
      <td>S0142</td>
      <td>55382.22</td>
      <td>72840.57</td>
      <td>70297.45</td>
      <td>198520.24</td>
    </tr>
    <tr>
      <th>62</th>
      <td>S0143</td>
      <td>14746.76</td>
      <td>20230.66</td>
      <td>19728.87</td>
      <td>54706.29</td>
    </tr>
  </tbody>
</table>
<p>63 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-ed3eb706-11d8-489d-8fe5-7a61e348be37')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-ed3eb706-11d8-489d-8fe5-7a61e348be37 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-ed3eb706-11d8-489d-8fe5-7a61e348be37');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-9f294075-d85e-4178-99d1-35ba82235bf1">
  <button class="colab-df-quickchart" onclick="quickchart('df-9f294075-d85e-4178-99d1-35ba82235bf1')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-9f294075-d85e-4178-99d1-35ba82235bf1 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_7e811233-7571-4a7e-aaa2-1a32f946fef2">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_revenue_store_p')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_7e811233-7571-4a7e-aaa2-1a32f946fef2 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_revenue_store_p');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="38"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
data-executionInfo="{&quot;elapsed&quot;:158,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895508708,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="QIlq-iVSkgFh" data-outputId="6084cad4-18f9-4cbf-8c3c-0a7c66dd8f25">
<div class="sourceCode" id="cb66"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vizualization of results</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt the DataFrame to have a long format for easier plotting</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>df_melted <span class="op">=</span> df_revenue_store_p.melt(id_vars<span class="op">=</span>[<span class="st">&#39;store_id&#39;</span>, <span class="st">&#39;total_rev&#39;</span>], var_name<span class="op">=</span><span class="st">&#39;Year&#39;</span>, value_name<span class="op">=</span><span class="st">&#39;revenue&#39;</span>)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a figure</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Add bar traces for each year</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>years <span class="op">=</span> df_melted[<span class="st">&#39;Year&#39;</span>].unique()</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> years:</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    df_year <span class="op">=</span> df_melted[df_melted[<span class="st">&#39;Year&#39;</span>] <span class="op">==</span> year]</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(go.Bar(x<span class="op">=</span>df_year[<span class="st">&#39;store_id&#39;</span>], y<span class="op">=</span>df_year[<span class="st">&#39;revenue&#39;</span>], name<span class="op">=</span><span class="ss">f&#39;</span><span class="sc">{</span>year<span class="sc">}</span><span class="ss">&#39;</span>))</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a line trace for total revenue per store</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df_revenue_store_p[<span class="st">&#39;store_id&#39;</span>],</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df_revenue_store_p[<span class="st">&#39;total_rev&#39;</span>],</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">&#39;lines+markers&#39;</span>,</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">&#39;Total Revenue&#39;</span>,</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">&#39;black&#39;</span>, dash<span class="op">=</span><span class="st">&#39;dash&#39;</span>)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Update layout</span></span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">&#39;Revenue per Store per Year&#39;</span>,</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">&#39;Store ID&#39;</span>,</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">&#39;Revenue&#39;</span>,</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">&#39;group&#39;</span></span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Show the plot</span></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="e9ff48eb-f926-4af3-b576-2ff916dac15d" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e9ff48eb-f926-4af3-b576-2ff916dac15d")) {                    Plotly.newPlot(                        "e9ff48eb-f926-4af3-b576-2ff916dac15d",                        [{"name":"2017","x":["S0002","S0003","S0005","S0007","S0010","S0012","S0014","S0015","S0016","S0020","S0022","S0023","S0026","S0030","S0032","S0036","S0038","S0039","S0040","S0041","S0045","S0046","S0050","S0052","S0055","S0056","S0058","S0059","S0061","S0062","S0067","S0068","S0071","S0072","S0073","S0076","S0077","S0080","S0083","S0085","S0086","S0088","S0089","S0091","S0092","S0094","S0095","S0097","S0099","S0102","S0104","S0107","S0108","S0109","S0120","S0122","S0126","S0131","S0132","S0136","S0141","S0142","S0143"],"y":[125121.21,32671.81,null,null,107462.65,50722.7,43376.37,100054.73,25344.44,291704.85,86118.69,107426.57,374368.36,11714.44,24051.4,null,257810.91,20457.64,142340.43,14706.22,28325.75,null,61576.71,56331.58,55367.07,143519.53,73755.38,13502.99,null,358167.09,59247.8,13805.7,null,75707.86,37069.090000000004,null,19237.2,57811.16,29159.62,575750.53,11288.130000000001,35020.0,11158.62,45199.77,null,115897.29,339635.8,604137.862,16609.63,77232.95,158689.6,50569.93,110152.18000000001,null,16180.89,43878.71,122873.73,50557.89,77662.74,4932.36,14213.18,55382.22,14746.76],"type":"bar"},{"name":"2018","x":["S0002","S0003","S0005","S0007","S0010","S0012","S0014","S0015","S0016","S0020","S0022","S0023","S0026","S0030","S0032","S0036","S0038","S0039","S0040","S0041","S0045","S0046","S0050","S0052","S0055","S0056","S0058","S0059","S0061","S0062","S0067","S0068","S0071","S0072","S0073","S0076","S0077","S0080","S0083","S0085","S0086","S0088","S0089","S0091","S0092","S0094","S0095","S0097","S0099","S0102","S0104","S0107","S0108","S0109","S0120","S0122","S0126","S0131","S0132","S0136","S0141","S0142","S0143"],"y":[175934.93,45476.8,52677.04,null,128455.1,73888.52,51926.35,130330.89,34191.81,371773.42,95796.04,148421.69,470548.1,14265.04,32755.68,51541.99,381439.31,29818.22,173460.11,11300.9,38162.72,50018.85,86125.27,62077.4,75263.01,202655.12,83823.35,38129.19,102330.51,465875.93,82978.45,20115.87,45903.14,116214.38,48844.66,25693.38,23886.0,77017.3,54877.73,776114.4,13704.17,42506.69,15646.94,66098.27,16689.38,186188.63,353971.22,430462.89,24728.27,95189.53,227126.9,58243.96,155844.15,12931.1,17686.18,62307.83,161388.17,66140.3,109195.17,9363.4,18244.170000000002,72840.57,20230.66],"type":"bar"},{"name":"2019","x":["S0002","S0003","S0005","S0007","S0010","S0012","S0014","S0015","S0016","S0020","S0022","S0023","S0026","S0030","S0032","S0036","S0038","S0039","S0040","S0041","S0045","S0046","S0050","S0052","S0055","S0056","S0058","S0059","S0061","S0062","S0067","S0068","S0071","S0072","S0073","S0076","S0077","S0080","S0083","S0085","S0086","S0088","S0089","S0091","S0092","S0094","S0095","S0097","S0099","S0102","S0104","S0107","S0108","S0109","S0120","S0122","S0126","S0131","S0132","S0136","S0141","S0142","S0143"],"y":[173764.53,48837.8,49383.51,21828.81,111551.65,68536.96,47806.96,121591.9,30294.95,344727.47,78308.25,142473.41,420559.44,19491.58,35453.73,55935.1,352328.63,27615.49,169079.73,8643.98,36477.24,53332.49,97420.29,46930.74,60773.08,202648.38,72877.71,35877.67,148405.46,431330.11,79543.1,24416.06,75353.96,122627.44,45982.61,44496.93,18813.21,69699.86,30589.28,726982.67,15169.960000000001,47094.96,19422.5,67430.3,45762.62,201335.03,280707.42,411999.77999999997,21446.91,71230.86,263901.72,48064.09,161513.55,54927.83,16888.13,64157.48,130143.68,67671.16,119892.39,13311.78,13844.22,70297.45,19728.87],"type":"bar"},{"line":{"color":"black","dash":"dash"},"mode":"lines+markers","name":"Total Revenue","x":["S0002","S0003","S0005","S0007","S0010","S0012","S0014","S0015","S0016","S0020","S0022","S0023","S0026","S0030","S0032","S0036","S0038","S0039","S0040","S0041","S0045","S0046","S0050","S0052","S0055","S0056","S0058","S0059","S0061","S0062","S0067","S0068","S0071","S0072","S0073","S0076","S0077","S0080","S0083","S0085","S0086","S0088","S0089","S0091","S0092","S0094","S0095","S0097","S0099","S0102","S0104","S0107","S0108","S0109","S0120","S0122","S0126","S0131","S0132","S0136","S0141","S0142","S0143"],"y":[474820.67000000004,126986.41,102060.55,21828.81,347469.4,193148.18,143109.68,351977.52,89831.2,1008205.74,260222.97999999998,398321.67000000004,1265475.9,45471.060000000005,92260.81,107477.09,991578.85,77891.35,484880.27,34651.1,102965.70999999999,103351.34,245122.27000000002,165339.72,191403.15999999997,548823.03,230456.44,87509.85,250735.96999999997,1255373.13,221769.35,58337.630000000005,121257.1,314549.68,131896.36,70190.31,61936.409999999996,204528.32,114626.63,2078847.6,40162.26,124621.65,46228.06,178728.34000000003,62452.0,503420.94999999995,974314.44,1446600.532,62784.81,243653.33999999997,649718.22,156877.97999999998,427509.88,67858.93000000001,50755.2,170344.02000000002,414405.58,184369.35,306750.3,27607.54,46301.57,198520.24,54706.28999999999],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Revenue per Store per Year"},"xaxis":{"title":{"text":"Store ID"}},"yaxis":{"title":{"text":"Revenue"}},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e9ff48eb-f926-4af3-b576-2ff916dac15d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html>
</div>
</div>
<div class="cell markdown" id="MlmC6YrElElb">
<p>S0085 has the higher revenue, followed by S0097, S0026 and S0062.</p>
<p>In general, 2017 was the year which had more revenue.</p>
</div>
<section id="revenue-and-sales-per-city" class="cell markdown"
id="BIPZjMpMa1gB">
<h1>Revenue and sales per city</h1>
</section>
<div class="cell code" data-execution_count="39"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:645}"
data-executionInfo="{&quot;elapsed&quot;:155,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895508708,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="hriwLMLKa2H5" data-outputId="1fcddf9f-a8cd-491d-9998-3c5b4e9aab14">
<div class="sourceCode" id="cb67"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Incorrectly encoded city codes</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>incorrect_city_names <span class="op">=</span> cities.city_code</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="co"># List of correct city codes</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>correct_city_names <span class="op">=</span> [<span class="st">&#39;Istanbul&#39;</span>, <span class="st">&#39;Antalya&#39;</span>, <span class="st">&#39;Sanliurfa&#39;</span>, <span class="st">&#39;Konya&#39;</span>, <span class="st">&#39;Izmir&#39;</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;Samsun&#39;</span>, <span class="st">&#39;Kahramanmaras&#39;</span>, <span class="st">&#39;Van&#39;</span>, <span class="st">&#39;Denizli&#39;</span>, <span class="st">&#39;Erzurum&#39;</span>,</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;Adana&#39;</span>, <span class="st">&#39;Gaziantep&#39;</span>, <span class="st">&#39;Diyarbakir&#39;</span>, <span class="st">&#39;Kayseri&#39;</span>, <span class="st">&#39;Bursa&#39;</span>,</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&#39;Mersin&#39;</span>, <span class="st">&#39;Ankara&#39;</span>, <span class="st">&#39;Adapazari&#39;</span>, <span class="st">&#39;Eskisehir&#39;</span>]</span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to find the best match for the incorrect code in the list of correct codes</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> correct_city_name(incorrect_name, correct_names):</span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>    best_match <span class="op">=</span> process.extractOne(incorrect_name, correct_names, scorer<span class="op">=</span>fuzz.ratio)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_match[<span class="dv">0</span>] <span class="cf">if</span> best_match <span class="cf">else</span> incorrect_name</span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace incorrect city code with correct ones</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>corrected_city_names <span class="op">=</span> [correct_city_name(name, correct_city_names) <span class="cf">for</span> name <span class="kw">in</span> incorrect_city_names]</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print unique correct city code</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span>(corrected_city_names)</span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>cities <span class="op">=</span> cities.assign(city_code<span class="op">=</span>corrected_city_names)</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a><span class="co"># join city from cities dataset</span></span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a>df_city <span class="op">=</span> pd.merge(filtered_sales, cities[[<span class="st">&#39;city_code&#39;</span>, <span class="st">&#39;store_id&#39;</span>]], on <span class="op">=</span> <span class="st">&#39;store_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>df_filter_rev <span class="op">=</span> df_city.groupby([<span class="st">&#39;city_code&#39;</span>, <span class="st">&#39;Year&#39;</span>])[<span class="st">&#39;revenue&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame so that &#39;Year&#39; values become columns</span></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a>df_pivot_rev <span class="op">=</span> df_filter_rev.pivot(index<span class="op">=</span><span class="st">&#39;city_code&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Year&#39;</span>, values<span class="op">=</span><span class="st">&#39;revenue&#39;</span>).reset_index()</span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the &#39;total&#39; column as sum of revenues across all years</span></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a>df_pivot_rev[<span class="st">&#39;total_rev&#39;</span>] <span class="op">=</span> df_pivot_rev.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the final DataFrame</span></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a>df_pivot_rev</span></code></pre></div>
<div class="output execute_result" data-execution_count="39">

  <div id="df-d51e2dad-d0bd-49db-ae4f-e399198cbacb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Year</th>
      <th>city_code</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>total_rev</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adana</td>
      <td>125121.210</td>
      <td>175934.93</td>
      <td>173764.53</td>
      <td>4.748207e+05</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adapazari</td>
      <td>110152.180</td>
      <td>155844.15</td>
      <td>161513.55</td>
      <td>4.275099e+05</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ankara</td>
      <td>158689.600</td>
      <td>227126.90</td>
      <td>263901.72</td>
      <td>6.497182e+05</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Antalya</td>
      <td>69868.240</td>
      <td>131116.57</td>
      <td>196383.41</td>
      <td>3.973682e+05</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Bursa</td>
      <td>257810.910</td>
      <td>381439.31</td>
      <td>352328.63</td>
      <td>9.915788e+05</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Denizli</td>
      <td>NaN</td>
      <td>104219.03</td>
      <td>105318.61</td>
      <td>2.095376e+05</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Diyarbakir</td>
      <td>77662.740</td>
      <td>109195.17</td>
      <td>119892.39</td>
      <td>3.067503e+05</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Erzurum</td>
      <td>77232.950</td>
      <td>95189.53</td>
      <td>71230.86</td>
      <td>2.436533e+05</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Eskisehir</td>
      <td>143519.530</td>
      <td>202655.12</td>
      <td>202648.38</td>
      <td>5.488230e+05</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Gaziantep</td>
      <td>35020.000</td>
      <td>42506.69</td>
      <td>47094.96</td>
      <td>1.246216e+05</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Istanbul</td>
      <td>3700997.222</td>
      <td>4448620.88</td>
      <td>4130233.48</td>
      <td>1.227985e+07</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Izmir</td>
      <td>25093.830</td>
      <td>33820.04</td>
      <td>39586.02</td>
      <td>9.849989e+04</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Kahramanmaras</td>
      <td>142340.430</td>
      <td>223478.96</td>
      <td>222412.22</td>
      <td>5.882316e+05</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Kayseri</td>
      <td>50557.890</td>
      <td>66140.30</td>
      <td>67671.16</td>
      <td>1.843694e+05</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Konya</td>
      <td>182993.950</td>
      <td>273294.24</td>
      <td>291124.06</td>
      <td>7.474122e+05</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Mersin</td>
      <td>29159.620</td>
      <td>54877.73</td>
      <td>30589.28</td>
      <td>1.146266e+05</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Samsun</td>
      <td>59905.990</td>
      <td>77399.17</td>
      <td>76074.28</td>
      <td>2.133794e+05</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Sanliurfa</td>
      <td>179631.030</td>
      <td>248892.24</td>
      <td>243108.13</td>
      <td>6.716314e+05</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Van</td>
      <td>24051.400</td>
      <td>135086.19</td>
      <td>183859.19</td>
      <td>3.429968e+05</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d51e2dad-d0bd-49db-ae4f-e399198cbacb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d51e2dad-d0bd-49db-ae4f-e399198cbacb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d51e2dad-d0bd-49db-ae4f-e399198cbacb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-500577ee-4d77-4576-8ad6-069329cc2ca5">
  <button class="colab-df-quickchart" onclick="quickchart('df-500577ee-4d77-4576-8ad6-069329cc2ca5')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-500577ee-4d77-4576-8ad6-069329cc2ca5 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_7ae0c7c5-954b-46ba-8558-84112b959b11">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_pivot_rev')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_7ae0c7c5-954b-46ba-8558-84112b959b11 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_pivot_rev');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="40"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
data-executionInfo="{&quot;elapsed&quot;:155,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895508709,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="mmbwBT6Va8h7" data-outputId="d4fbc8d0-7afd-484d-e587-2802683a068a">
<div class="sourceCode" id="cb68"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plotly figure</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> go.Figure()</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add bar traces for each year</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> year <span class="kw">in</span> df_pivot_rev.columns[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>]:  <span class="co"># Exclude &#39;city_code&#39; and &#39;total&#39; columns</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>    fig.add_trace(go.Bar(</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>        x<span class="op">=</span>df_pivot_rev[<span class="st">&#39;city_code&#39;</span>],</span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>        y<span class="op">=</span>df_pivot_rev[year],</span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>        name<span class="op">=</span><span class="bu">str</span>(year)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a line trace for the total revenue</span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a>fig.add_trace(go.Scatter(</span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>df_pivot_rev[<span class="st">&#39;city_code&#39;</span>],</span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a>    y<span class="op">=</span>df_pivot_rev[<span class="st">&#39;total_rev&#39;</span>],</span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a>    mode<span class="op">=</span><span class="st">&#39;lines+markers&#39;</span>,</span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a>    name<span class="op">=</span><span class="st">&#39;Total&#39;</span></span>
<span id="cb68-18"><a href="#cb68-18" aria-hidden="true" tabindex="-1"></a>))</span>
<span id="cb68-19"><a href="#cb68-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-20"><a href="#cb68-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Update layout</span></span>
<span id="cb68-21"><a href="#cb68-21" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb68-22"><a href="#cb68-22" aria-hidden="true" tabindex="-1"></a>    title<span class="op">=</span><span class="st">&#39;Revenue per City per Year&#39;</span>,</span>
<span id="cb68-23"><a href="#cb68-23" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">&#39;City Code&#39;</span>,</span>
<span id="cb68-24"><a href="#cb68-24" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">&#39;Revenue&#39;</span>,</span>
<span id="cb68-25"><a href="#cb68-25" aria-hidden="true" tabindex="-1"></a>    barmode<span class="op">=</span><span class="st">&#39;group&#39;</span></span>
<span id="cb68-26"><a href="#cb68-26" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output display_data">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="2df54d76-b851-4d58-8b84-1d9ec1f1fb6b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("2df54d76-b851-4d58-8b84-1d9ec1f1fb6b")) {                    Plotly.newPlot(                        "2df54d76-b851-4d58-8b84-1d9ec1f1fb6b",                        [{"name":"2017","x":["Adana","Adapazari","Ankara","Antalya","Bursa","Denizli","Diyarbakir","Erzurum","Eskisehir","Gaziantep","Istanbul","Izmir","Kahramanmaras","Kayseri","Konya","Mersin","Samsun","Sanliurfa","Van"],"y":[125121.21,110152.18000000001,158689.6,69868.24,257810.91,null,77662.74,77232.95,143519.53,35020.0,3700997.222,25093.83,142340.43,50557.89,182993.95,29159.62,59905.99,179631.03,24051.4],"type":"bar"},{"name":"2018","x":["Adana","Adapazari","Ankara","Antalya","Bursa","Denizli","Diyarbakir","Erzurum","Eskisehir","Gaziantep","Istanbul","Izmir","Kahramanmaras","Kayseri","Konya","Mersin","Samsun","Sanliurfa","Van"],"y":[175934.93,155844.15,227126.9,131116.57,381439.31,104219.03,109195.17,95189.53,202655.12,42506.69,4448620.88,33820.04,223478.96,66140.3,273294.24,54877.73,77399.17,248892.24,135086.19],"type":"bar"},{"name":"2019","x":["Adana","Adapazari","Ankara","Antalya","Bursa","Denizli","Diyarbakir","Erzurum","Eskisehir","Gaziantep","Istanbul","Izmir","Kahramanmaras","Kayseri","Konya","Mersin","Samsun","Sanliurfa","Van"],"y":[173764.53,161513.55,263901.72,196383.41,352328.63,105318.61,119892.39,71230.86,202648.38,47094.96,4130233.48,39586.02,222412.22,67671.16,291124.06,30589.28,76074.28,243108.13,183859.19],"type":"bar"},{"mode":"lines+markers","name":"Total","x":["Adana","Adapazari","Ankara","Antalya","Bursa","Denizli","Diyarbakir","Erzurum","Eskisehir","Gaziantep","Istanbul","Izmir","Kahramanmaras","Kayseri","Konya","Mersin","Samsun","Sanliurfa","Van"],"y":[474820.67000000004,427509.88,649718.22,397368.22,991578.85,209537.64,306750.3,243653.33999999997,548823.03,124621.65,12279851.582,98499.89,588231.61,184369.35,747412.25,114626.63,213379.44,671631.4,342996.78],"type":"scatter"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"Revenue per City per Year"},"xaxis":{"title":{"text":"City Code"}},"yaxis":{"title":{"text":"Revenue"}},"barmode":"group"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('2df54d76-b851-4d58-8b84-1d9ec1f1fb6b');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html>
</div>
</div>
<div class="cell code" data-execution_count="41"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:645}"
data-executionInfo="{&quot;elapsed&quot;:153,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895508709,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="TQv-97xWa-zp" data-outputId="981ac6e7-f683-42fc-a696-55c40b433518">
<div class="sourceCode" id="cb69"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>df_filter_s <span class="op">=</span> df_city.groupby([<span class="st">&#39;city_code&#39;</span>, <span class="st">&#39;Year&#39;</span>])[<span class="st">&#39;sales&#39;</span>].<span class="bu">sum</span>().reset_index()</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame so that &#39;Year&#39; values become columns</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>df_pivot_s <span class="op">=</span> df_filter_s.pivot(index<span class="op">=</span><span class="st">&#39;city_code&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Year&#39;</span>, values<span class="op">=</span><span class="st">&#39;sales&#39;</span>).reset_index()</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the &#39;total&#39; column as sum of revenues across all years</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>df_pivot_s[<span class="st">&#39;total_sales&#39;</span>] <span class="op">=</span> df_pivot_s.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the final DataFrame</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>df_pivot_s</span></code></pre></div>
<div class="output execute_result" data-execution_count="41">

  <div id="df-91c0cdd7-0929-4874-90e3-cccacb8dd0fc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Year</th>
      <th>city_code</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>total_sales</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Adana</td>
      <td>37411.430</td>
      <td>37387.370</td>
      <td>26793.500</td>
      <td>101592.300</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Adapazari</td>
      <td>26298.750</td>
      <td>27843.205</td>
      <td>19588.190</td>
      <td>73730.145</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ankara</td>
      <td>46923.002</td>
      <td>47336.465</td>
      <td>35587.640</td>
      <td>129847.107</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Antalya</td>
      <td>26723.350</td>
      <td>35689.440</td>
      <td>37425.608</td>
      <td>99838.398</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Bursa</td>
      <td>80016.333</td>
      <td>73529.088</td>
      <td>44878.474</td>
      <td>198423.895</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Denizli</td>
      <td>NaN</td>
      <td>24490.128</td>
      <td>16620.851</td>
      <td>41110.979</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Diyarbakir</td>
      <td>22960.251</td>
      <td>26603.801</td>
      <td>18089.354</td>
      <td>67653.406</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Erzurum</td>
      <td>20441.450</td>
      <td>19110.240</td>
      <td>11814.675</td>
      <td>51366.365</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Eskisehir</td>
      <td>35800.679</td>
      <td>41853.976</td>
      <td>26665.963</td>
      <td>104320.618</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Gaziantep</td>
      <td>13478.000</td>
      <td>10681.025</td>
      <td>7798.000</td>
      <td>31957.025</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Istanbul</td>
      <td>980482.494</td>
      <td>909851.241</td>
      <td>610856.723</td>
      <td>2501190.458</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Izmir</td>
      <td>9803.905</td>
      <td>10773.490</td>
      <td>8971.780</td>
      <td>29549.175</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Kahramanmaras</td>
      <td>43512.718</td>
      <td>45735.683</td>
      <td>30704.069</td>
      <td>119952.470</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Kayseri</td>
      <td>16234.025</td>
      <td>15962.975</td>
      <td>11630.000</td>
      <td>43827.000</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Konya</td>
      <td>57102.898</td>
      <td>71326.049</td>
      <td>50786.244</td>
      <td>179215.191</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Mersin</td>
      <td>8624.535</td>
      <td>9536.000</td>
      <td>5995.675</td>
      <td>24156.210</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Samsun</td>
      <td>17973.716</td>
      <td>17720.000</td>
      <td>11780.000</td>
      <td>47473.716</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Sanliurfa</td>
      <td>51743.930</td>
      <td>57365.145</td>
      <td>40775.120</td>
      <td>149884.195</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Van</td>
      <td>10412.800</td>
      <td>30448.050</td>
      <td>27672.480</td>
      <td>68533.330</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-91c0cdd7-0929-4874-90e3-cccacb8dd0fc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-91c0cdd7-0929-4874-90e3-cccacb8dd0fc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-91c0cdd7-0929-4874-90e3-cccacb8dd0fc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-a5b9bea8-efbc-4c51-8406-662cf2645357">
  <button class="colab-df-quickchart" onclick="quickchart('df-a5b9bea8-efbc-4c51-8406-662cf2645357')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-a5b9bea8-efbc-4c51-8406-662cf2645357 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_c8ee9d97-b9d2-4c0f-b915-eec31e22b4e3">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_pivot_s')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_c8ee9d97-b9d2-4c0f-b915-eec31e22b4e3 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_pivot_s');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="JdS2JC0M9HC_">
<p>####Sales = 0 What does sales = 0 mean?</p>
</div>
<div class="cell code" data-execution_count="42"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:575,&quot;referenced_widgets&quot;:[&quot;91e060fb9c2d4f328d09e2e1af546efa&quot;,&quot;aebb30ce7e324909952e2f1502b3f544&quot;,&quot;5f55321f191f464fa3d59b4c5dce7900&quot;,&quot;15a7e44ee6804344a1e6fb6b71bbb4a4&quot;,&quot;49a89a4f8b614ebb8301e5b1098c6a0a&quot;,&quot;a89fa554e2d74126bf7c7111603205b3&quot;,&quot;68262d731ded4591a35e8fc53c9e18ad&quot;,&quot;be49c9bd1d2d476bba01ecd9a6edecff&quot;,&quot;31ee163a0f7749bbb75471378eca952b&quot;,&quot;40fb4e724c224f4cba0a17704381d0e1&quot;]}"
data-executionInfo="{&quot;elapsed&quot;:152,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895508709,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="wpsn7dg9YTMu" data-outputId="b890986c-5344-422b-c647-1a5b0b50f34f">
<div class="sourceCode" id="cb70"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Função para filtrar por loja e produto</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> filter_sales(store, product):</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>    filtered_df <span class="op">=</span> sales[(sales[<span class="st">&#39;store_id&#39;</span>] <span class="op">==</span> store) <span class="op">&amp;</span> (sales[<span class="st">&#39;product_id&#39;</span>] <span class="op">==</span> product)]</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    display(filtered_df[[<span class="st">&#39;date&#39;</span>, <span class="st">&#39;store_id&#39;</span>, <span class="st">&#39;product_id&#39;</span>, <span class="st">&#39;sales&#39;</span>, <span class="st">&#39;revenue&#39;</span>, <span class="st">&#39;stock&#39;</span>]])</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Criar widgets para seleção interativa</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>store_dropdown <span class="op">=</span> widgets.Dropdown(options<span class="op">=</span>sales[<span class="st">&#39;store_id&#39;</span>].unique(), description<span class="op">=</span><span class="st">&#39;Select Store:&#39;</span>)</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>product_dropdown <span class="op">=</span> widgets.Dropdown(options<span class="op">=</span>sales[<span class="st">&#39;product_id&#39;</span>].unique(), description<span class="op">=</span><span class="st">&#39;Select Product:&#39;</span>)</span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Interagir com a função de filtro através dos widgets</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>widgets.interact(filter_sales, store<span class="op">=</span>store_dropdown, product<span class="op">=</span>product_dropdown)</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb71"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;91e060fb9c2d4f328d09e2e1af546efa&quot;</span><span class="fu">,</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output execute_result" data-execution_count="42">
<div style="max-width:800px; border: 1px solid var(--colab-border-color);"><style>
      pre.function-repr-contents {
        overflow-x: auto;
        padding: 8px 12px;
        max-height: 500px;
      }

      pre.function-repr-contents.function-repr-contents-collapsed {
        cursor: pointer;
        max-height: 100px;
      }
    </style>
    <pre style="white-space: initial; background:
         var(--colab-secondary-surface-color); padding: 8px 12px;
         border-bottom: 1px solid var(--colab-border-color);"><b>filter_sales</b><br/>def filter_sales(store, product)</pre><pre class="function-repr-contents function-repr-contents-collapsed" style=""><a class="filepath" style="display:none" href="#">/content/&lt;ipython-input-42-1e78c2e8c7b9&gt;</a>&lt;no docstring&gt;</pre></div>
</div>
</div>
<div class="cell markdown" id="QO0kkz2ZDvmB">
<p>When <strong>sales = 0</strong>, there were no sales, and the stock
value remains unchanged. When a sale occurs, the stock value decreases
accordingly.</p>
<p>Each row with sales = 0 represents the stock of the respective
product, for that day.</p>
</div>
<div class="cell markdown" id="Q3CTRXXuGncp">
<p>####Are there duplicated rows for each product per day?</p>
</div>
<div class="cell code" data-execution_count="43"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
data-executionInfo="{&quot;elapsed&quot;:7247,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895515818,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="nk44qTWhQmNV" data-outputId="d1b8239f-57bf-4cd6-f85a-a027ef961299">
<div class="sourceCode" id="cb72"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># counts how many times each product was sold in each store on each date.</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>sales[<span class="st">&#39;date&#39;</span>] <span class="op">=</span> pd.to_datetime(sales[<span class="st">&#39;date&#39;</span>])</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>df_sales_pr<span class="op">=</span>sales.groupby([<span class="st">&#39;date&#39;</span>,<span class="st">&#39;product_id&#39;</span>,<span class="st">&#39;store_id&#39;</span>])[<span class="st">&#39;product_id&#39;</span>].count().reset_index(name<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>df_sales_pr</span></code></pre></div>
<div class="output execute_result" data-execution_count="43">

  <div id="df-5ff13646-417a-4d5d-a235-9860a59be915" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>product_id</th>
      <th>store_id</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2017-01-02</td>
      <td>P0001</td>
      <td>S0002</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2017-01-02</td>
      <td>P0001</td>
      <td>S0012</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2017-01-02</td>
      <td>P0001</td>
      <td>S0023</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2017-01-02</td>
      <td>P0001</td>
      <td>S0040</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2017-01-02</td>
      <td>P0001</td>
      <td>S0050</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>8886053</th>
      <td>2019-10-31</td>
      <td>P0748</td>
      <td>S0108</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8886054</th>
      <td>2019-10-31</td>
      <td>P0748</td>
      <td>S0126</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8886055</th>
      <td>2019-10-31</td>
      <td>P0748</td>
      <td>S0131</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8886056</th>
      <td>2019-10-31</td>
      <td>P0748</td>
      <td>S0132</td>
      <td>1</td>
    </tr>
    <tr>
      <th>8886057</th>
      <td>2019-10-31</td>
      <td>P0748</td>
      <td>S0142</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>8886058 rows × 4 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5ff13646-417a-4d5d-a235-9860a59be915')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5ff13646-417a-4d5d-a235-9860a59be915 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5ff13646-417a-4d5d-a235-9860a59be915');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-06b0662c-5104-4b06-abc7-add4691b166b">
  <button class="colab-df-quickchart" onclick="quickchart('df-06b0662c-5104-4b06-abc7-add4691b166b')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-06b0662c-5104-4b06-abc7-add4691b166b button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_f1a81d58-0955-4ce9-b5e8-fc8c1929f713">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_sales_pr')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_f1a81d58-0955-4ce9-b5e8-fc8c1929f713 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_sales_pr');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="44"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:5,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895515818,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="v4Bdnl1sS77A" data-outputId="e4c7bd0b-8719-4c34-af1b-541f3b30c72d">
<div class="sourceCode" id="cb73"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> df_sales_pr[<span class="st">&#39;count&#39;</span>].<span class="bu">max</span>()<span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;All product IDs are unique.&quot;</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;There are duplicate product IDs.&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>All product IDs are unique.
</code></pre>
</div>
</div>
<div class="cell markdown" id="2ZQad90J5xyU">
<p>Every day, each product has <strong>only</strong> a row showing if
there were or not sales.</p>
</div>
<section id="sales-per-product" class="cell markdown" id="8DDQMVd236O1">
<h3>Sales per product</h3>
</section>
<div class="cell code" data-execution_count="45"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:423}"
data-executionInfo="{&quot;elapsed&quot;:1329,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895517144,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="sgdOIzn835ET" data-outputId="225a4797-72e3-4c5a-f287-e1dc7b3de135">
<div class="sourceCode" id="cb75"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter the sales DataFrame to include only positive sales</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>filtered_sales <span class="op">=</span> sales[sales[<span class="st">&#39;sales&#39;</span>] <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>df_sales_product <span class="op">=</span> filtered_sales.groupby([<span class="st">&#39;product_id&#39;</span>, <span class="st">&#39;Year&#39;</span>]).size().reset_index(name<span class="op">=</span><span class="st">&#39;count&#39;</span>)</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Pivot the DataFrame</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>df_sales_product <span class="op">=</span> df_sales_product.pivot(index<span class="op">=</span><span class="st">&#39;product_id&#39;</span>, columns<span class="op">=</span><span class="st">&#39;Year&#39;</span>, values<span class="op">=</span><span class="st">&#39;count&#39;</span>).reset_index()</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>df_sales_product.columns.name <span class="op">=</span> <span class="va">None</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Add a new column for the sum of each store across all years</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>df_sales_product[<span class="st">&#39;total&#39;</span>] <span class="op">=</span> df_sales_product.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, numeric_only<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>df_sales_product</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">

  <div id="df-9f9b929a-ca4d-4233-8e5a-c44f10b65aad" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>product_id</th>
      <th>2017</th>
      <th>2018</th>
      <th>2019</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>P0001</td>
      <td>250.0</td>
      <td>880.0</td>
      <td>345.0</td>
      <td>1475.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>P0002</td>
      <td>6.0</td>
      <td>21.0</td>
      <td>5.0</td>
      <td>32.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>P0004</td>
      <td>128.0</td>
      <td>144.0</td>
      <td>5.0</td>
      <td>277.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>P0005</td>
      <td>135.0</td>
      <td>160.0</td>
      <td>91.0</td>
      <td>386.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>P0006</td>
      <td>NaN</td>
      <td>47.0</td>
      <td>19.0</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>593</th>
      <td>P0740</td>
      <td>141.0</td>
      <td>174.0</td>
      <td>162.0</td>
      <td>477.0</td>
    </tr>
    <tr>
      <th>594</th>
      <td>P0741</td>
      <td>NaN</td>
      <td>87.0</td>
      <td>89.0</td>
      <td>176.0</td>
    </tr>
    <tr>
      <th>595</th>
      <td>P0742</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>84.0</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>596</th>
      <td>P0747</td>
      <td>2948.0</td>
      <td>2568.0</td>
      <td>1983.0</td>
      <td>7499.0</td>
    </tr>
    <tr>
      <th>597</th>
      <td>P0748</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>217.0</td>
      <td>217.0</td>
    </tr>
  </tbody>
</table>
<p>598 rows × 5 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9f9b929a-ca4d-4233-8e5a-c44f10b65aad')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9f9b929a-ca4d-4233-8e5a-c44f10b65aad button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9f9b929a-ca4d-4233-8e5a-c44f10b65aad');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-3b9dc75f-f03a-433b-a87a-c9fcd315f183">
  <button class="colab-df-quickchart" onclick="quickchart('df-3b9dc75f-f03a-433b-a87a-c9fcd315f183')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-3b9dc75f-f03a-433b-a87a-c9fcd315f183 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_84913ac0-edf7-41ca-8380-b51c0a43d46b">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('df_sales_product')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_84913ac0-edf7-41ca-8380-b51c0a43d46b button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('df_sales_product');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell code" data-execution_count="46"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:542}"
data-executionInfo="{&quot;elapsed&quot;:10,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895517146,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="Ra8j2ZOk5au4" data-outputId="c85857d8-5b9c-434f-cbf4-f15297d1b344">
<div class="sourceCode" id="cb76"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt the DataFrame to long format for use with plotly</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>df_product_long <span class="op">=</span> pd.melt(df_sales_product, id_vars<span class="op">=</span>[<span class="st">&#39;product_id&#39;</span>], value_vars<span class="op">=</span>[<span class="dv">2017</span>, <span class="dv">2018</span>, <span class="dv">2019</span>],</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>                  var_name<span class="op">=</span><span class="st">&#39;Year&#39;</span>, value_name<span class="op">=</span><span class="st">&#39;count&#39;</span>).dropna()</span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the plot using plotly.express</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.bar(df_product_long, x<span class="op">=</span><span class="st">&#39;product_id&#39;</span>, y<span class="op">=</span><span class="st">&#39;count&#39;</span>, color<span class="op">=</span><span class="st">&#39;Year&#39;</span>,</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>             title<span class="op">=</span><span class="st">&#39;Sales Count per Product by Year&#39;</span>,</span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>             labels<span class="op">=</span>{<span class="st">&#39;store_id&#39;</span>: <span class="st">&#39;Store ID&#39;</span>, <span class="st">&#39;count&#39;</span>: <span class="st">&#39;Sales Count&#39;</span>})</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Update layout for better readability</span></span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a>fig.update_layout(xaxis<span class="op">=</span><span class="bu">dict</span>(tickangle<span class="op">=</span><span class="dv">45</span>))</span>
<span id="cb76-12"><a href="#cb76-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-13"><a href="#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the plot</span></span>
<span id="cb76-14"><a href="#cb76-14" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code></pre></div>
<div class="output display_data">
<html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>                <div id="900b8116-e48c-4506-88c5-5ab9048c676f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("900b8116-e48c-4506-88c5-5ab9048c676f")) {                    Plotly.newPlot(                        "900b8116-e48c-4506-88c5-5ab9048c676f",                        [{"alignmentgroup":"True","hovertemplate":"Year=2017\u003cbr\u003eproduct_id=%{x}\u003cbr\u003eSales Count=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"2017","marker":{"color":"#636efa","pattern":{"shape":""}},"name":"2017","offsetgroup":"2017","orientation":"v","showlegend":true,"textposition":"auto","x":["P0001","P0002","P0004","P0005","P0011","P0014","P0015","P0016","P0017","P0018","P0024","P0035","P0042","P0043","P0044","P0046","P0050","P0051","P0054","P0055","P0057","P0059","P0060","P0061","P0062","P0066","P0067","P0068","P0070","P0071","P0072","P0073","P0079","P0080","P0082","P0083","P0089","P0090","P0092","P0095","P0097","P0099","P0102","P0103","P0104","P0108","P0109","P0110","P0114","P0116","P0117","P0125","P0126","P0129","P0130","P0131","P0132","P0134","P0137","P0140","P0141","P0144","P0145","P0147","P0148","P0150","P0151","P0152","P0154","P0157","P0158","P0160","P0161","P0162","P0163","P0164","P0165","P0166","P0167","P0169","P0170","P0171","P0172","P0174","P0175","P0176","P0177","P0178","P0183","P0184","P0185","P0187","P0189","P0192","P0195","P0196","P0197","P0198","P0201","P0202","P0203","P0204","P0205","P0206","P0211","P0212","P0213","P0214","P0215","P0216","P0218","P0219","P0220","P0223","P0225","P0226","P0227","P0229","P0231","P0233","P0234","P0237","P0241","P0242","P0246","P0249","P0251","P0252","P0258","P0260","P0261","P0263","P0264","P0267","P0268","P0272","P0275","P0277","P0278","P0279","P0280","P0282","P0283","P0286","P0287","P0290","P0291","P0294","P0296","P0297","P0300","P0302","P0304","P0305","P0311","P0312","P0316","P0317","P0321","P0324","P0325","P0327","P0328","P0329","P0330","P0332","P0333","P0336","P0337","P0340","P0341","P0343","P0345","P0348","P0350","P0351","P0352","P0353","P0355","P0356","P0358","P0361","P0364","P0369","P0370","P0372","P0376","P0377","P0382","P0386","P0389","P0390","P0391","P0393","P0394","P0397","P0398","P0399","P0400","P0402","P0405","P0406","P0408","P0412","P0413","P0415","P0416","P0417","P0420","P0422","P0423","P0425","P0427","P0428","P0432","P0433","P0435","P0436","P0437","P0438","P0439","P0440","P0446","P0448","P0450","P0453","P0454","P0456","P0458","P0459","P0461","P0465","P0466","P0469","P0470","P0471","P0473","P0476","P0477","P0481","P0483","P0484","P0485","P0490","P0491","P0492","P0495","P0497","P0499","P0500","P0503","P0504","P0506","P0510","P0511","P0513","P0514","P0515","P0518","P0520","P0521","P0524","P0525","P0526","P0527","P0533","P0534","P0536","P0543","P0544","P0550","P0551","P0555","P0556","P0557","P0561","P0565","P0566","P0567","P0569","P0571","P0572","P0574","P0575","P0579","P0581","P0582","P0583","P0584","P0585","P0587","P0590","P0591","P0594","P0599","P0601","P0602","P0608","P0609","P0610","P0611","P0613","P0614","P0615","P0616","P0619","P0621","P0623","P0625","P0628","P0631","P0635","P0637","P0639","P0640","P0642","P0643","P0644","P0645","P0646","P0647","P0649","P0651","P0652","P0654","P0655","P0656","P0657","P0658","P0659","P0660","P0661","P0662","P0663","P0664","P0665","P0666","P0669","P0671","P0673","P0678","P0679","P0681","P0682","P0684","P0688","P0689","P0690","P0691","P0693","P0694","P0695","P0696","P0697","P0698","P0699","P0700","P0701","P0703","P0704","P0705","P0706","P0707","P0710","P0711","P0712","P0718","P0720","P0721","P0726","P0730","P0732","P0735","P0737","P0738","P0740","P0747"],"xaxis":"x","y":[250.0,6.0,128.0,135.0,42.0,16.0,3831.0,182.0,7279.0,699.0,531.0,5854.0,850.0,9.0,1178.0,931.0,57.0,9272.0,1273.0,2106.0,515.0,521.0,672.0,17.0,1118.0,224.0,885.0,572.0,2202.0,114.0,49.0,138.0,5534.0,66.0,34.0,727.0,57.0,1656.0,3841.0,29.0,317.0,545.0,67.0,16392.0,122.0,31.0,319.0,1765.0,4254.0,3558.0,36.0,6905.0,86.0,5805.0,2148.0,8106.0,424.0,825.0,222.0,5206.0,996.0,577.0,43.0,1656.0,1342.0,35.0,129.0,76.0,19.0,987.0,9.0,38.0,40.0,536.0,77.0,218.0,980.0,77.0,7.0,1736.0,7.0,2615.0,16.0,749.0,550.0,139.0,804.0,84.0,538.0,33.0,7644.0,578.0,113.0,2.0,1323.0,1045.0,2501.0,3881.0,981.0,327.0,188.0,285.0,45.0,2239.0,209.0,2350.0,256.0,70.0,7.0,11.0,8.0,3520.0,1527.0,1205.0,132.0,1067.0,350.0,293.0,418.0,122.0,46.0,36.0,1121.0,635.0,105.0,1800.0,23.0,214.0,818.0,2106.0,8434.0,69.0,137.0,109.0,1812.0,339.0,3883.0,4117.0,41.0,164.0,2543.0,545.0,767.0,4556.0,863.0,56.0,24.0,416.0,7091.0,322.0,11.0,17.0,14.0,242.0,6250.0,94.0,1926.0,27.0,439.0,26.0,5287.0,3481.0,123.0,73.0,741.0,367.0,11845.0,703.0,45.0,279.0,465.0,40.0,1146.0,7479.0,141.0,710.0,3.0,747.0,271.0,2129.0,199.0,213.0,13027.0,247.0,218.0,6063.0,919.0,564.0,583.0,23.0,1981.0,2427.0,2.0,116.0,1801.0,513.0,699.0,315.0,1292.0,1652.0,156.0,827.0,1112.0,1061.0,2797.0,205.0,143.0,370.0,340.0,18.0,19.0,1647.0,5209.0,636.0,162.0,37.0,1057.0,8644.0,560.0,13613.0,1428.0,14.0,1686.0,1603.0,37.0,2871.0,1749.0,222.0,4662.0,4484.0,335.0,6.0,650.0,1.0,986.0,100.0,125.0,28.0,302.0,1007.0,2035.0,64.0,82.0,260.0,132.0,68.0,23.0,468.0,8124.0,8923.0,271.0,275.0,914.0,255.0,99.0,48.0,1083.0,30.0,55.0,1545.0,1018.0,381.0,399.0,7.0,3048.0,744.0,948.0,6125.0,2851.0,9.0,329.0,2152.0,148.0,262.0,354.0,1343.0,1921.0,5.0,334.0,11952.0,85.0,4696.0,2480.0,124.0,621.0,196.0,519.0,57.0,2250.0,831.0,2876.0,6439.0,45.0,34.0,18.0,185.0,1210.0,3642.0,166.0,854.0,1359.0,2109.0,525.0,787.0,37.0,48.0,1193.0,51.0,54.0,179.0,295.0,513.0,397.0,4959.0,299.0,4630.0,25.0,11.0,27.0,185.0,118.0,309.0,1547.0,1906.0,255.0,518.0,64.0,314.0,1229.0,49.0,1868.0,16.0,20.0,5291.0,9852.0,1596.0,68.0,93.0,1539.0,341.0,195.0,223.0,3929.0,3449.0,45.0,98.0,2634.0,1057.0,134.0,45.0,2682.0,660.0,34.0,138.0,110.0,135.0,32.0,35.0,112.0,3392.0,1670.0,57.0,340.0,20.0,1213.0,978.0,4640.0,553.0,912.0,6091.0,528.0,464.0,2098.0,222.0,10.0,141.0,2948.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"Year=2018\u003cbr\u003eproduct_id=%{x}\u003cbr\u003eSales Count=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"2018","marker":{"color":"#EF553B","pattern":{"shape":""}},"name":"2018","offsetgroup":"2018","orientation":"v","showlegend":true,"textposition":"auto","x":["P0001","P0002","P0004","P0005","P0006","P0007","P0008","P0010","P0011","P0014","P0015","P0016","P0017","P0018","P0021","P0024","P0028","P0029","P0035","P0036","P0037","P0039","P0041","P0042","P0043","P0044","P0046","P0050","P0051","P0053","P0054","P0055","P0057","P0058","P0059","P0060","P0061","P0062","P0063","P0065","P0066","P0067","P0068","P0070","P0071","P0072","P0073","P0075","P0077","P0078","P0079","P0080","P0082","P0083","P0084","P0087","P0089","P0090","P0092","P0093","P0094","P0095","P0097","P0099","P0100","P0101","P0102","P0103","P0104","P0105","P0108","P0109","P0110","P0112","P0113","P0114","P0116","P0117","P0125","P0126","P0129","P0130","P0131","P0132","P0134","P0137","P0138","P0140","P0141","P0144","P0145","P0147","P0148","P0150","P0151","P0152","P0154","P0156","P0157","P0158","P0160","P0161","P0162","P0163","P0164","P0165","P0166","P0167","P0169","P0170","P0171","P0172","P0174","P0175","P0176","P0177","P0178","P0179","P0180","P0183","P0184","P0185","P0186","P0187","P0189","P0190","P0192","P0195","P0196","P0197","P0198","P0201","P0202","P0203","P0204","P0205","P0206","P0209","P0210","P0211","P0212","P0213","P0214","P0215","P0216","P0218","P0219","P0220","P0222","P0223","P0225","P0226","P0227","P0229","P0231","P0233","P0234","P0237","P0238","P0240","P0241","P0242","P0246","P0247","P0249","P0251","P0252","P0255","P0256","P0258","P0260","P0261","P0263","P0264","P0265","P0267","P0268","P0271","P0272","P0275","P0276","P0277","P0278","P0279","P0280","P0282","P0283","P0286","P0287","P0290","P0291","P0293","P0294","P0295","P0296","P0297","P0299","P0300","P0301","P0302","P0304","P0305","P0311","P0312","P0316","P0317","P0318","P0321","P0324","P0325","P0327","P0328","P0329","P0330","P0332","P0333","P0336","P0337","P0339","P0340","P0341","P0343","P0344","P0345","P0346","P0347","P0348","P0350","P0351","P0352","P0353","P0354","P0355","P0356","P0358","P0361","P0362","P0363","P0364","P0366","P0369","P0370","P0372","P0374","P0376","P0377","P0379","P0381","P0382","P0386","P0388","P0389","P0390","P0391","P0392","P0393","P0394","P0397","P0398","P0399","P0400","P0402","P0405","P0406","P0408","P0411","P0412","P0413","P0414","P0415","P0416","P0417","P0419","P0420","P0421","P0422","P0423","P0425","P0427","P0428","P0431","P0432","P0433","P0435","P0436","P0437","P0438","P0439","P0440","P0444","P0446","P0448","P0450","P0451","P0453","P0454","P0455","P0456","P0457","P0458","P0459","P0461","P0462","P0465","P0466","P0469","P0470","P0471","P0473","P0474","P0475","P0476","P0477","P0480","P0481","P0483","P0484","P0485","P0487","P0489","P0490","P0491","P0492","P0493","P0495","P0497","P0498","P0499","P0500","P0502","P0503","P0504","P0506","P0509","P0510","P0511","P0513","P0514","P0515","P0517","P0518","P0520","P0521","P0522","P0523","P0524","P0525","P0527","P0528","P0531","P0533","P0534","P0536","P0537","P0539","P0540","P0541","P0543","P0544","P0546","P0548","P0550","P0551","P0553","P0554","P0555","P0556","P0557","P0561","P0565","P0566","P0567","P0569","P0571","P0572","P0574","P0575","P0579","P0581","P0582","P0583","P0584","P0585","P0587","P0588","P0590","P0591","P0592","P0593","P0594","P0599","P0600","P0601","P0602","P0603","P0606","P0608","P0609","P0610","P0611","P0613","P0614","P0615","P0616","P0619","P0621","P0622","P0623","P0628","P0631","P0632","P0635","P0637","P0639","P0640","P0641","P0642","P0643","P0644","P0645","P0646","P0647","P0649","P0651","P0652","P0654","P0655","P0656","P0657","P0658","P0659","P0660","P0661","P0662","P0663","P0664","P0665","P0666","P0667","P0669","P0671","P0673","P0674","P0678","P0679","P0681","P0682","P0684","P0685","P0687","P0688","P0689","P0690","P0691","P0693","P0694","P0695","P0696","P0697","P0698","P0699","P0700","P0701","P0703","P0704","P0705","P0706","P0707","P0710","P0711","P0712","P0714","P0716","P0718","P0720","P0721","P0726","P0729","P0730","P0731","P0732","P0733","P0735","P0736","P0737","P0738","P0739","P0740","P0741","P0747"],"xaxis":"x","y":[880.0,21.0,144.0,160.0,47.0,78.0,151.0,80.0,21.0,12.0,3690.0,307.0,6668.0,2130.0,70.0,719.0,23.0,4.0,6104.0,94.0,5.0,8.0,81.0,1198.0,81.0,981.0,852.0,42.0,10106.0,37.0,1758.0,2069.0,323.0,1604.0,2521.0,673.0,1942.0,160.0,842.0,10.0,35.0,935.0,583.0,1638.0,60.0,15.0,316.0,21.0,68.0,983.0,4246.0,48.0,268.0,725.0,23.0,4238.0,1.0,1873.0,4143.0,3.0,4.0,7.0,351.0,82.0,807.0,190.0,83.0,18178.0,152.0,158.0,86.0,483.0,1332.0,302.0,230.0,4295.0,3362.0,126.0,7919.0,40.0,5287.0,2592.0,11019.0,815.0,488.0,193.0,1188.0,4600.0,1280.0,548.0,24.0,2013.0,997.0,42.0,146.0,151.0,58.0,307.0,784.0,47.0,61.0,31.0,493.0,76.0,215.0,1229.0,44.0,1174.0,1796.0,12.0,2960.0,5.0,883.0,553.0,24.0,1182.0,92.0,596.0,1.0,410.0,41.0,8426.0,717.0,755.0,699.0,22.0,27.0,1362.0,711.0,2664.0,4058.0,1097.0,96.0,204.0,271.0,20.0,2088.0,13.0,760.0,863.0,2245.0,208.0,74.0,8.0,1334.0,20.0,2620.0,1251.0,25.0,1749.0,205.0,994.0,385.0,291.0,435.0,91.0,61.0,24.0,1174.0,65.0,992.0,858.0,192.0,190.0,1503.0,28.0,414.0,151.0,19.0,768.0,2362.0,8800.0,46.0,75.0,1919.0,10.0,1803.0,569.0,402.0,4509.0,61.0,4361.0,77.0,151.0,2693.0,318.0,717.0,5092.0,676.0,26.0,69.0,71.0,406.0,18.0,7841.0,329.0,70.0,59.0,65.0,13.0,1750.0,642.0,6254.0,92.0,1831.0,147.0,3766.0,363.0,433.0,5976.0,2052.0,583.0,44.0,179.0,429.0,12473.0,631.0,73.0,56.0,297.0,407.0,21.0,33.0,731.0,5.0,199.0,7754.0,251.0,806.0,76.0,1005.0,184.0,439.0,1393.0,204.0,177.0,1023.0,79.0,13720.0,54.0,201.0,180.0,7591.0,288.0,806.0,397.0,36.0,5.0,593.0,29.0,5326.0,1712.0,2873.0,36.0,63.0,94.0,3716.0,347.0,78.0,294.0,1048.0,1599.0,1571.0,1173.0,1172.0,295.0,899.0,3001.0,209.0,178.0,4.0,497.0,648.0,141.0,378.0,33.0,10.0,1631.0,4587.0,3801.0,714.0,80.0,91.0,1439.0,9037.0,694.0,12631.0,1444.0,11.0,5.0,1886.0,557.0,71.0,74.0,2047.0,1403.0,1660.0,229.0,8.0,4431.0,4001.0,821.0,1.0,9.0,528.0,46.0,1288.0,76.0,14.0,63.0,119.0,75.0,697.0,69.0,812.0,1788.0,70.0,56.0,119.0,82.0,199.0,211.0,86.0,73.0,26.0,1212.0,76.0,8806.0,9437.0,5.0,311.0,370.0,1009.0,1627.0,242.0,405.0,71.0,1376.0,19.0,74.0,65.0,1229.0,498.0,31.0,19.0,421.0,405.0,3285.0,3.0,2032.0,570.0,1432.0,6410.0,2.0,366.0,5.0,8.0,2871.0,3.0,1.0,4159.0,350.0,2844.0,54.0,25.0,5.0,364.0,296.0,1295.0,3911.0,640.0,7.0,12915.0,70.0,5239.0,3873.0,884.0,435.0,149.0,642.0,56.0,2194.0,670.0,2913.0,3.0,6585.0,48.0,3.0,28.0,28.0,33.0,546.0,181.0,1296.0,26.0,18.0,3724.0,36.0,1.0,1195.0,2031.0,365.0,1760.0,59.0,112.0,1216.0,96.0,17.0,219.0,286.0,1.0,524.0,396.0,4573.0,130.0,107.0,4285.0,9.0,1.0,51.0,262.0,158.0,253.0,1171.0,1586.0,230.0,670.0,18.0,316.0,1293.0,136.0,1460.0,22.0,29.0,6743.0,9443.0,758.0,31.0,8.0,39.0,1326.0,504.0,205.0,121.0,217.0,3674.0,4408.0,54.0,120.0,9.0,145.0,2973.0,900.0,124.0,39.0,2370.0,762.0,152.0,96.0,309.0,95.0,27.0,315.0,105.0,3350.0,1726.0,43.0,562.0,17.0,1179.0,1145.0,326.0,30.0,3239.0,117.0,2055.0,3894.0,328.0,1044.0,657.0,520.0,1351.0,2056.0,79.0,225.0,92.0,298.0,174.0,87.0,2568.0],"yaxis":"y","type":"bar"},{"alignmentgroup":"True","hovertemplate":"Year=2019\u003cbr\u003eproduct_id=%{x}\u003cbr\u003eSales Count=%{y}\u003cextra\u003e\u003c\u002fextra\u003e","legendgroup":"2019","marker":{"color":"#00cc96","pattern":{"shape":""}},"name":"2019","offsetgroup":"2019","orientation":"v","showlegend":true,"textposition":"auto","x":["P0001","P0002","P0004","P0005","P0006","P0007","P0008","P0009","P0010","P0011","P0012","P0014","P0015","P0016","P0017","P0018","P0021","P0022","P0024","P0025","P0026","P0028","P0029","P0031","P0033","P0035","P0037","P0039","P0041","P0042","P0043","P0044","P0045","P0046","P0047","P0048","P0049","P0050","P0051","P0053","P0054","P0055","P0057","P0058","P0059","P0060","P0061","P0062","P0063","P0065","P0066","P0067","P0068","P0070","P0071","P0072","P0073","P0075","P0076","P0077","P0078","P0079","P0080","P0082","P0083","P0084","P0085","P0087","P0088","P0089","P0090","P0092","P0093","P0094","P0095","P0096","P0097","P0099","P0100","P0101","P0102","P0103","P0104","P0105","P0108","P0110","P0112","P0113","P0114","P0116","P0117","P0119","P0122","P0124","P0125","P0126","P0127","P0128","P0129","P0130","P0131","P0132","P0134","P0135","P0137","P0138","P0140","P0141","P0142","P0144","P0145","P0147","P0148","P0149","P0150","P0151","P0152","P0154","P0155","P0156","P0157","P0158","P0159","P0160","P0161","P0162","P0163","P0164","P0165","P0166","P0167","P0169","P0170","P0171","P0172","P0173","P0174","P0175","P0176","P0177","P0178","P0179","P0180","P0181","P0182","P0183","P0184","P0185","P0186","P0187","P0188","P0189","P0190","P0193","P0195","P0196","P0197","P0198","P0201","P0202","P0203","P0204","P0205","P0206","P0209","P0210","P0211","P0212","P0213","P0214","P0215","P0216","P0217","P0218","P0219","P0220","P0221","P0222","P0223","P0225","P0226","P0227","P0228","P0229","P0231","P0232","P0233","P0234","P0237","P0238","P0239","P0240","P0241","P0242","P0245","P0246","P0247","P0249","P0251","P0252","P0255","P0256","P0258","P0259","P0260","P0261","P0263","P0264","P0265","P0266","P0267","P0268","P0269","P0270","P0271","P0272","P0275","P0276","P0277","P0278","P0279","P0280","P0282","P0283","P0286","P0287","P0290","P0291","P0293","P0294","P0295","P0296","P0297","P0299","P0300","P0301","P0302","P0304","P0305","P0309","P0310","P0311","P0312","P0314","P0316","P0317","P0318","P0321","P0322","P0324","P0325","P0326","P0327","P0328","P0329","P0330","P0331","P0332","P0333","P0335","P0336","P0337","P0339","P0340","P0341","P0343","P0344","P0345","P0346","P0347","P0348","P0350","P0351","P0352","P0353","P0354","P0355","P0356","P0358","P0360","P0361","P0362","P0363","P0364","P0366","P0369","P0370","P0371","P0372","P0373","P0374","P0376","P0377","P0379","P0381","P0382","P0386","P0388","P0389","P0390","P0391","P0392","P0393","P0394","P0395","P0397","P0398","P0399","P0400","P0402","P0405","P0406","P0408","P0411","P0412","P0413","P0414","P0415","P0416","P0417","P0418","P0419","P0420","P0421","P0422","P0423","P0424","P0425","P0426","P0427","P0428","P0431","P0432","P0433","P0435","P0436","P0437","P0438","P0439","P0441","P0442","P0444","P0445","P0446","P0448","P0450","P0451","P0452","P0453","P0454","P0455","P0456","P0457","P0458","P0459","P0461","P0462","P0463","P0464","P0465","P0466","P0467","P0469","P0470","P0471","P0473","P0474","P0475","P0476","P0477","P0480","P0481","P0482","P0483","P0484","P0485","P0487","P0489","P0490","P0491","P0492","P0493","P0494","P0495","P0496","P0497","P0498","P0499","P0500","P0501","P0502","P0503","P0504","P0505","P0506","P0508","P0509","P0510","P0511","P0512","P0513","P0514","P0515","P0516","P0517","P0518","P0520","P0521","P0522","P0523","P0524","P0525","P0527","P0528","P0529","P0531","P0532","P0533","P0534","P0536","P0537","P0539","P0540","P0541","P0543","P0544","P0545","P0546","P0547","P0548","P0549","P0550","P0551","P0552","P0553","P0554","P0555","P0556","P0557","P0559","P0560","P0561","P0563","P0565","P0566","P0567","P0569","P0570","P0571","P0572","P0574","P0575","P0576","P0579","P0581","P0582","P0583","P0584","P0585","P0587","P0588","P0590","P0591","P0592","P0593","P0594","P0595","P0597","P0598","P0599","P0601","P0602","P0603","P0606","P0608","P0609","P0610","P0611","P0613","P0614","P0615","P0616","P0617","P0619","P0621","P0622","P0623","P0625","P0626","P0628","P0629","P0630","P0631","P0632","P0633","P0634","P0635","P0637","P0638","P0639","P0640","P0641","P0642","P0643","P0644","P0645","P0646","P0647","P0649","P0651","P0652","P0654","P0655","P0656","P0657","P0658","P0659","P0660","P0661","P0662","P0663","P0664","P0665","P0666","P0667","P0668","P0669","P0670","P0671","P0672","P0673","P0674","P0675","P0676","P0678","P0679","P0680","P0681","P0682","P0683","P0684","P0685","P0687","P0688","P0689","P0690","P0691","P0692","P0693","P0694","P0695","P0696","P0697","P0698","P0699","P0700","P0701","P0702","P0703","P0704","P0705","P0706","P0707","P0708","P0709","P0710","P0711","P0712","P0713","P0714","P0716","P0718","P0720","P0721","P0724","P0725","P0726","P0729","P0730","P0731","P0732","P0733","P0735","P0736","P0737","P0738","P0739","P0740","P0741","P0742","P0747","P0748"],"xaxis":"x","y":[345.0,5.0,5.0,91.0,19.0,110.0,148.0,421.0,21.0,16.0,49.0,8.0,2472.0,145.0,4760.0,1591.0,12.0,98.0,28.0,104.0,2080.0,419.0,26.0,68.0,240.0,4350.0,13.0,1745.0,86.0,739.0,81.0,595.0,237.0,111.0,103.0,118.0,28.0,15.0,7956.0,55.0,1478.0,1623.0,102.0,3.0,1486.0,339.0,2464.0,7.0,341.0,8.0,5.0,569.0,59.0,23.0,20.0,6.0,182.0,29.0,15.0,31.0,959.0,2392.0,1.0,48.0,819.0,2.0,223.0,3889.0,1099.0,12.0,803.0,41.0,16.0,49.0,23.0,23.0,236.0,13.0,466.0,113.0,50.0,14251.0,58.0,14.0,61.0,472.0,320.0,84.0,3434.0,2415.0,159.0,85.0,51.0,62.0,5953.0,10.0,18.0,19.0,4248.0,1790.0,10347.0,327.0,56.0,6.0,100.0,213.0,2863.0,973.0,1.0,387.0,19.0,1122.0,16.0,966.0,22.0,97.0,81.0,53.0,31.0,158.0,335.0,4.0,1.0,8.0,6.0,355.0,36.0,186.0,461.0,15.0,67.0,1193.0,4.0,2382.0,5.0,36.0,571.0,58.0,71.0,735.0,87.0,66.0,10.0,57.0,6948.0,250.0,103.0,6279.0,811.0,555.0,66.0,817.0,96.0,32.0,812.0,541.0,1492.0,2646.0,248.0,20.0,118.0,281.0,7.0,983.0,19.0,631.0,540.0,1558.0,142.0,65.0,2.0,779.0,932.0,130.0,2828.0,652.0,257.0,60.0,1041.0,17.0,166.0,387.0,140.0,243.0,117.0,15.0,86.0,24.0,66.0,1588.0,897.0,88.0,662.0,277.0,143.0,76.0,117.0,957.0,21.0,558.0,165.0,46.0,18.0,197.0,1655.0,7830.0,18.0,20.0,575.0,132.0,76.0,1225.0,2042.0,1.0,304.0,255.0,127.0,108.0,3035.0,60.0,53.0,1997.0,343.0,627.0,3099.0,393.0,8.0,18.0,9.0,230.0,8.0,7124.0,298.0,3.0,12.0,9.0,11.0,432.0,224.0,93.0,4.0,4610.0,25.0,4.0,489.0,64.0,3293.0,149.0,124.0,204.0,4589.0,14.0,296.0,491.0,19.0,11.0,87.0,283.0,9783.0,64.0,541.0,19.0,47.0,205.0,295.0,9.0,579.0,15.0,38.0,163.0,5876.0,202.0,601.0,5.0,295.0,61.0,125.0,434.0,29.0,64.0,55.0,1176.0,21.0,10061.0,76.0,50.0,217.0,492.0,5444.0,823.0,55.0,442.0,211.0,65.0,27.0,453.0,15.0,4798.0,954.0,2242.0,275.0,75.0,81.0,25.0,249.0,10.0,13.0,155.0,489.0,986.0,853.0,520.0,895.0,265.0,836.0,1524.0,680.0,57.0,5.0,157.0,7.0,388.0,92.0,541.0,16.0,7.0,20.0,755.0,308.0,3481.0,2957.0,2843.0,35.0,76.0,886.0,7603.0,431.0,7.0,908.0,571.0,290.0,31.0,58.0,1145.0,19.0,56.0,141.0,265.0,470.0,1045.0,2478.0,118.0,3.0,1144.0,3963.0,108.0,17.0,212.0,156.0,7.0,439.0,19.0,35.0,966.0,23.0,2.0,13.0,127.0,78.0,604.0,140.0,615.0,103.0,1016.0,63.0,66.0,8.0,115.0,116.0,156.0,72.0,20.0,18.0,20.0,57.0,494.0,128.0,8337.0,8193.0,63.0,4.0,186.0,295.0,26.0,780.0,94.0,932.0,33.0,266.0,1537.0,21.0,912.0,20.0,19.0,108.0,77.0,432.0,15.0,57.0,46.0,206.0,70.0,2252.0,133.0,58.0,3372.0,204.0,258.0,1006.0,5275.0,254.0,162.0,17.0,6.0,1691.0,10.0,241.0,134.0,16.0,6872.0,1451.0,258.0,622.0,49.0,47.0,35.0,66.0,161.0,244.0,320.0,413.0,565.0,479.0,2072.0,98.0,5.0,9568.0,116.0,51.0,2713.0,2590.0,319.0,193.0,143.0,41.0,122.0,66.0,706.0,632.0,1374.0,9.0,4944.0,59.0,3.0,25.0,17.0,15.0,9.0,523.0,3.0,13.0,192.0,12.0,113.0,1932.0,32.0,2.0,715.0,1130.0,327.0,817.0,19.0,12.0,18.0,258.0,35.0,14.0,198.0,7.0,298.0,505.0,7.0,78.0,7.0,32.0,8.0,386.0,235.0,23.0,3606.0,34.0,134.0,2696.0,33.0,24.0,15.0,52.0,52.0,183.0,634.0,1001.0,195.0,269.0,5.0,223.0,1063.0,35.0,943.0,3.0,9.0,5357.0,7222.0,460.0,32.0,15.0,131.0,8.0,258.0,767.0,22.0,1.0,27.0,32.0,110.0,6.0,44.0,1184.0,66.0,3267.0,38.0,22.0,36.0,168.0,130.0,472.0,26.0,75.0,226.0,16.0,1806.0,533.0,110.0,23.0,218.0,46.0,19.0,235.0,692.0,46.0,2782.0,929.0,32.0,295.0,56.0,4160.0,11.0,852.0,777.0,19.0,209.0,288.0,2282.0,2.0,1117.0,93.0,181.0,3.0,236.0,726.0,406.0,465.0,3341.0,1022.0,62.0,111.0,62.0,610.0,162.0,89.0,84.0,1983.0,217.0],"yaxis":"y","type":"bar"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"product_id"},"tickangle":45},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Sales Count"}},"legend":{"title":{"text":"Year"},"tracegroupgap":0},"title":{"text":"Sales Count per Product by Year"},"barmode":"relative"},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('900b8116-e48c-4506-88c5-5ab9048c676f');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                            </script>        </div>
</body>
</html>
</div>
</div>
<div class="cell markdown" id="7VdH0t6A6MC2">
<p>P0103 seems to have more sells, followed by P0364, P033 and P0569</p>
<p>Some products do not show data for 2017 or 2018 sales -&gt; new
collections?</p>
</div>
<div class="cell markdown" id="2_gnzDIA8VrN">
<p>###Stores per city</p>
</div>
<div class="cell code" data-execution_count="47"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
data-executionInfo="{&quot;elapsed&quot;:9,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895517147,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="GwzS-jf98Zfd" data-outputId="cef91e56-5bad-462b-9b9c-91a1986dc50a">
<div class="sourceCode" id="cb77"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>stores_city<span class="op">=</span>cities.groupby(<span class="st">&#39;city_code&#39;</span>)[<span class="st">&#39;store_id&#39;</span>].count()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>st<span class="op">=</span>stores_city.sort_values(ascending<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>st.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="47">
<pre><code>city_code
Istanbul     32
Antalya       5
Sanliurfa     3
Konya         3
Van           2
Name: store_id, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown" id="yzmJ-qN6i2y0">
<p>Istanbul has the majority of stores (6x more than Antalya)</p>
</div>
<div class="cell markdown" id="f3WHZUaylBWT">
<p>###Top selling products by city</p>
</div>
<div class="cell code" data-execution_count="48"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:1000}"
data-executionInfo="{&quot;elapsed&quot;:9951,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895527448,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="JSQ28aQIlA3n" data-outputId="db90ded6-6aae-41e9-dc43-3ed87828eaf7">
<div class="sourceCode" id="cb79"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge sales and products</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(sales[[<span class="st">&#39;date&#39;</span>, <span class="st">&#39;store_id&#39;</span>, <span class="st">&#39;product_id&#39;</span>, <span class="st">&#39;sales&#39;</span>, <span class="st">&#39;revenue&#39;</span>, <span class="st">&#39;stock&#39;</span>, <span class="st">&#39;price&#39;</span> ]], product[[<span class="st">&#39;product_id&#39;</span>]], on<span class="op">=</span><span class="st">&#39;product_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>merged <span class="op">=</span> pd.merge(merged, cities[[<span class="st">&#39;city_code&#39;</span>, <span class="st">&#39;store_id&#39;</span>]], on <span class="op">=</span> <span class="st">&#39;store_id&#39;</span>, how<span class="op">=</span><span class="st">&#39;left&#39;</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co">#group by city_code and product_id and count sales</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>m_pro<span class="op">=</span>merged.groupby([<span class="st">&#39;city_code&#39;</span>,<span class="st">&#39;product_id&#39;</span>])[<span class="st">&#39;sales&#39;</span>].count()</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>o<span class="op">=</span>pd.DataFrame(m_pro.sort_values(ascending<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Sort the data by city and sales count</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>o <span class="op">=</span> o.sort_values(by<span class="op">=</span>[<span class="st">&#39;city_code&#39;</span>, <span class="st">&#39;sales&#39;</span>], ascending<span class="op">=</span>[<span class="va">True</span>, <span class="va">False</span>])</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Get top 5 products per city</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>o_top5 <span class="op">=</span> o.groupby(<span class="st">&#39;city_code&#39;</span>).head(<span class="dv">3</span>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>o_top5</span></code></pre></div>
<div class="output execute_result" data-execution_count="48">

  <div id="df-c145d738-1338-4bc0-b458-654c0eca6814" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>sales</th>
    </tr>
    <tr>
      <th>city_code</th>
      <th>product_id</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">Adana</th>
      <th>P0099</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0435</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0131</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Adapazari</th>
      <th>P0556</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0459</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0456</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Ankara</th>
      <th>P0195</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0131</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0196</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Antalya</th>
      <th>P0325</th>
      <td>3144</td>
    </tr>
    <tr>
      <th>P0664</th>
      <td>3133</td>
    </tr>
    <tr>
      <th>P0261</th>
      <td>3130</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Bursa</th>
      <th>P0688</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0666</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0608</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Denizli</th>
      <th>P0125</th>
      <td>1199</td>
    </tr>
    <tr>
      <th>P0694</th>
      <td>1199</td>
    </tr>
    <tr>
      <th>P0747</th>
      <td>1199</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Diyarbakir</th>
      <th>P0456</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0450</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0125</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Erzurum</th>
      <th>P0099</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0005</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0054</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Eskisehir</th>
      <th>P0125</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0184</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0297</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Gaziantep</th>
      <th>P0067</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0325</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0212</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Istanbul</th>
      <th>P0103</th>
      <td>29802</td>
    </tr>
    <tr>
      <th>P0664</th>
      <td>29785</td>
    </tr>
    <tr>
      <th>P0694</th>
      <td>29730</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Izmir</th>
      <th>P0261</th>
      <td>2002</td>
    </tr>
    <tr>
      <th>P0348</th>
      <td>2001</td>
    </tr>
    <tr>
      <th>P0125</th>
      <td>2001</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Kahramanmaras</th>
      <th>P0129</th>
      <td>1572</td>
    </tr>
    <tr>
      <th>P0212</th>
      <td>1572</td>
    </tr>
    <tr>
      <th>P0277</th>
      <td>1570</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Kayseri</th>
      <th>P0131</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0177</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0399</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Konya</th>
      <th>P0453</th>
      <td>3004</td>
    </tr>
    <tr>
      <th>P0125</th>
      <td>3003</td>
    </tr>
    <tr>
      <th>P0536</th>
      <td>3002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Mersin</th>
      <th>P0608</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0652</th>
      <td>1002</td>
    </tr>
    <tr>
      <th>P0665</th>
      <td>1002</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Samsun</th>
      <th>P0663</th>
      <td>2004</td>
    </tr>
    <tr>
      <th>P0664</th>
      <td>2001</td>
    </tr>
    <tr>
      <th>P0499</th>
      <td>1999</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Sanliurfa</th>
      <th>P0297</th>
      <td>3006</td>
    </tr>
    <tr>
      <th>P0712</th>
      <td>3006</td>
    </tr>
    <tr>
      <th>P0131</th>
      <td>3006</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">Van</th>
      <th>P0131</th>
      <td>1552</td>
    </tr>
    <tr>
      <th>P0125</th>
      <td>1552</td>
    </tr>
    <tr>
      <th>P0015</th>
      <td>1551</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c145d738-1338-4bc0-b458-654c0eca6814')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c145d738-1338-4bc0-b458-654c0eca6814 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c145d738-1338-4bc0-b458-654c0eca6814');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-c11d5e5a-b1c4-4ca4-9ad9-66c77a8f5d12">
  <button class="colab-df-quickchart" onclick="quickchart('df-c11d5e5a-b1c4-4ca4-9ad9-66c77a8f5d12')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-c11d5e5a-b1c4-4ca4-9ad9-66c77a8f5d12 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_bbd3ab0d-b6a0-4f88-875b-0f1a25bbefb0">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('o_top5')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_bbd3ab0d-b6a0-4f88-875b-0f1a25bbefb0 button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('o_top5');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="Gsu9xcCHkFWB">
<p>The number of products sold (top 3) in each city is similar, except
for Istanbul where the top 3 products sold could be almost 30x
higher.</p>
</div>
<section id="product" class="cell markdown" id="3eA6jria7q6S">
<h2>Product</h2>
</section>
<div class="cell code" data-execution_count="49"
data-executionInfo="{&quot;elapsed&quot;:14,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895527449,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="aC2q_aU57chE">
<div class="sourceCode" id="cb80"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_product = ProfileReport(product, title=&quot;Product Profiling Report&quot;)</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_product</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_product.to_file(&quot;Product Profiling Report.html&quot;)</span></span></code></pre></div>
</div>
<section id="forecast-revenue" class="cell markdown" id="emCHKcLq7rZM">
<h2>Forecast Revenue</h2>
</section>
<div class="cell code" data-execution_count="50"
data-executionInfo="{&quot;elapsed&quot;:12,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1720895527449,&quot;user&quot;:{&quot;displayName&quot;:&quot;Natalia Magalhaes&quot;,&quot;userId&quot;:&quot;14345586299802829491&quot;},&quot;user_tz&quot;:-60}"
id="2FqgIQXU7cdF">
<div class="sourceCode" id="cb81"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_fore_rev = ProfileReport(fore_rev, title=&quot;Forecast Revenue Profiling Report&quot;)</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_fore_rev</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="co">#profile_fore_rev.to_file(&quot;Forecast Revenue Profiling Report.html&quot;)</span></span></code></pre></div>
</div>
</body>
</html>
